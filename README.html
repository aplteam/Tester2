<!DOCTYPE html>
<html lang="en" style="scroll-behavior:smooth" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>Meddy</title>
<style media="screen">
html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}body{margin:0;}article,aside,footer,header,nav,section{display:block;}h1{font-size:2em;margin:0.67em 0;}figcaption,figure,main{display:block;}figure{margin:1em 40px;}hr{box-sizing:content-box;height:0;overflow:visible;}pre{font-family:monospace, monospace;font-size:1em;}a{background-color:transparent;-webkit-text-decoration-skip:objects;}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted;}b,strong{font-weight:inherit;}b,strong{font-weight:bolder;}code,kbd,samp{font-family:monospace, monospace;font-size:1em;}dfn{font-style:italic;}mark{background-color:#ff0;color:#000;}small{font-size:0.8em;}sub,sup{font-size:0.75em;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}audio,video{display:inline-block;}audio:not([controls]){display:none;height:0;}img{border-style:none;}svg:not(:root){overflow:hidden;}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:1em;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button,html [type="button"], [type="reset"],[type="submit"]{-webkit-appearance:button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{display:inline-block;vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details, menu{display:block;}summary{display:list-item;}canvas{display:inline-block;}template{display:none;}[hidden]{display:none;}body{margin:0;font-family:"Bookman Old Style", "Callisto MT", Bookman, "Goudy Old Style", Garamond, serif;background-color:#fdfdfd;font-size:18px;line-height:1.4;max-width:none;padding:0.83em;color:#292929;word-wrap:break-word;overflow-wrap:break-word;}h1, h2, h3, h4, h5, h6{color:#404040;font-weight:800;padding-left:0;}h1, h2, h3, h4, h5, h6{font-family:"Century Gothic", Verdana, "Sans";}h1, h2, h3, h4, p{margin-bottom:0.88em;}h1{font-size:1.8em;margin:0.27em 0 1.11em 0;}h1 > code, h2 > code, h3 > code, h4 > code, h5 > code, h6 > code{font-size:1em;background-color:inherit;}h2{font-size:1.44em;margin:0.55em 0 0.55em 0;padding-top:0.55em;border-bottom:1px solid Silver;}h3{margin:0;margin-top:0.55em;font-size:1.22em;}nav h3{font-size:0.88em;margin-left:0.83em;margin-bottom:0.27em;}h4{font-size:1em;margin:0;margin-top:0.55em;}h5{font-size:0.94em;margin:0;margin-top:0.66em;padding:0;}h6{font-size:0.88em;margin:0;margin-top:0.66em;padding:0;}a{color:#0099ff;margin:0;padding:0;vertical-align:baseline;}a:visited{color:purple;}a.autoheader_anchor{text-decoration:none;}ul{list-style-type:disc;}ul, ol{padding:0;margin:0;}dd{padding-top:0.25em;}p.first_dd{padding-top:0.25em;}li > ul, ol{padding-bottom:0;}li{line-height:1.3;margin-left:1.38em;margin-bottom:0.55em;}ul > li{margin-left:2.5em;}ol > li{margin-left:2.5em;}li ul{margin-left:0.55em;}li ul{margin-left:0.27em;}li p{padding:1px 0 0 0;margin:0.55em 0 0.27em 0;line-height:1.3;}ul, ol{line-height:1.3;padding:0.33em 0 0 0;margin:0.5em;}p{line-height:1.2;padding:0.40em 0 0 0;margin:0;}pre{overflow:scroll;padding:0.55em 0.27em;margin:0.55em 0 0.55em 0 !important;background-color:#faebd7;color:#3e3e3e;border:1px Silver dashed;display:block;font-family:APLFont, monospace;font-weight:normal;white-space:pre-wrap;}pre > code{line-height:1.2;border:0;padding:0;margin:0;background-color:inherit;color:inherit;font-weight:inherit;white-space:pre-wrap;}td code{padding:0;}a code{padding:0;font-size:1em;}nav code{background-color:inherit;font-weight:400;color:inherit;}code{font-family:APLFont, monospace;color:Black;font-weight:800;line-height:1.2;font-size:0.88em;margin:0;color:#950000;padding:0 0.16em;}tbody tr:nth-child(even){background-color:#F0F0F0;}th{background-color:#E6E6E6;color:black;}th, td{padding:0.16em 0.55em;vertical-align:top;}table td + td{border-left:1px solid gray;}table th + th{border-left:1px solid gray;}table{border-color:Black;margin:1.5em 0;border:2px black;border-collapse:collapse;font-family:APLFont;font-size:0.88em;line-height:1.2;border:1px solid Gray;}li > table{margin:0.55em 0 0.55em 0;}tr{margin:1.11em;}th{font-weight:bold;}tfoot td{font-weight:bold;}blockquote{border-left:0.27em solid silver;padding-left:0.27em;margin:0.83em 0.27em 0.83em 0.55em;}blockquote ul li{margin-left:1.38em;}blockquote ol li{margin-left:1.38em;}li > blockquote{margin-left:0;}nav{background-color:#f5f5f5;border:1px solid Black;padding:0.55em;margin:0.55em;margin-right:0;box-shadow:0.27em 0.27em 0.27em Gray;overflow:hidden;clear:both;}nav#main_nav{position:fixed;top:0;right:0.55em;float:none;width:auto;}nav#main_nav_no_collapse li{font-size:0.77rem;}nav#main_nav_no_collapse li{line-height:1.5;}nav ul{list-style-type:none;margin:0 0 0.11em 0;padding:0;}nav a:visited{color:black;}nav ul li{margin-bottom:0.16em;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{font-size:0.75rem;line-height:1.3;padding:0;margin-top:0;margin-bottom:0;margin-left:0.83em;}nav p{font-weight:bold;font-size:0.75rem;padding-top:0;}dl{margin-top:0.1em;margin-bottom:0.1em;}dt{margin-top:0.75em;margin-bottom:0.1em;font-weight:800;}label#hide_toc_label{font-size:0.8em;}.toc-container{position:relative;height:auto;}div.toc-container h1{font-size:0.88em;margin:0.27em 0 0.27em 0;}[type="checkbox"]{position:absolute;left:-9999px;}label{display:block;width:100%;height:1.1em;cursor:pointer;top:0;padding-left:1.1em;}label:before{content:'Table of contents \25BC';font-weight:bold;font-size:90%;padding-bottom:0;}[type="checkbox"] ~ div{display:none;}[type="checkbox"]:checked ~ div{display:block;margin-top:1.1em;}[type="checkbox"]:checked + label{top:100%;}[type="checkbox"]:checked + label:before{content:'Table of contents ▲';}div#footnotes_div p{line-height:1;padding-bottom:0;padding-top:0;}div#footnotes_div ol{padding-top:0;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("http://misc.aplteam.com/apl385.ttf") format("truetype");}.no_display{display:none;}.red{color:red;}.center{text-align:center;margin-left:auto;margin-right:auto;}.left{text-align:left;margin-right:0 auto;}.right{text-align:right;margin-left:0 auto;}img{margin-top:0.55em;margin-bottom:0.27em;}div.leanpub{padding:0.83em 0.55em 1.11em 0;margin:0.55em 0 0 0.27em;overflow:auto;}div.leanpub_A{border:1px solid black;background-color:#f1f1f1;padding:0.55em;margin:1.11em 0 0.83em 0;}div.leanpub h3, div.leanpub_A h3{font-size:1.2em;padding:0;margin:0;}div.leanpub h4, div.leanpub_A h4{font-size:1.1em;padding:0.27em 0 0 0;margin:0;}div.leanpub h5, div.leanpub h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub_A h5, div.leanpub_A h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub img{padding:0;margin:0 1.11em 0.27em 0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub img{float:left;padding:0;margin:0.55em 1.11em 0 0;clear:both;}div.leanpub tbody *{background-color:transparent;}div.leanpub p{padding:0.17em 0 0 0;margin:0;}span.leanpub_code{color:Red;}div.leanpub p{display:block;padding:0.44em 0 0 0;}div.leanpub > div{margin-left:2.27em;}.print_only{display:none;}
</style>
<style media="print">
@page{margin:25mm 20mm 25mm 20mm;}body{font-family:"Bookman Old Style", "Callisto MT", Bookman,"Goudy Old Style", Garamond, serif;font-size:9pt;line-height:1.2;}h1{font-size:170%;}h2{font-size:110%;}h3{font-size:110%;}h4{font-size:105%;}h5{font-size:100%;}h6{font-size:95%;}h1{margin:0 0 20pt 0;}h2{margin:15pt 0 3pt 0;}h3{margin:10pt 0 0pt 0;}h4{margin:10pt 0 0pt 0;}h5{margin:9pt 0 0pt 0;}h6{margin:9pt 0 0pt 0;}h1, h2, h3, h4, h5, h6{color:black;font-family:"Century Gothic", Verdana, "Sans";page-break-after:avoid;}h1 > code, h2 > code, h3 > code, h4 > code, h5 > code, h6 > code{font-size:100%;}h2{border-bottom:1pt solid Silver;padding-bottom:2pt;}.h_tag{page-break-after:avoid;break-after:avoid;}abbr[title]{border-bottom:0;text-decoration:none;}a{color:black;margin:0;padding:0;vertical-align:baseline;text-decoration:none;font-style:italic;}a.autoheader_anchor{text-decoration:none;font-style:normal;page-break-after:avoid;break-after:avoid;}ul{list-style-type:square;}ul, ol{padding:0;margin:0;}li > ul, ol{padding-bottom:0;}li{line-height:1.3;margin-left:13pt;margin-bottom:5pt;}ul > li{margin-left:25pt;}ol > li{margin-left:25pt;}li ul{margin-left:5pt;}li ul{margin-left:3pt;}li p{padding:1pt 0 0 0;margin:5pt 0 3pt 0;line-height:1.3;}p, ul, ol{line-height:1.3;padding:4pt 0 0 0;margin:0;color:black;}ul, ol{margin-top:0.75em;}pre{padding:3pt;margin:5pt 0;white-space:pre-wrap;background-color:#FAFAFA;border:1pt Silver solid;display:block;font-family:APLFont, monospace;page-break-inside:avoid;}pre code{background-color:#FAFAFA;color:Black;padding:0;margin:0 0 -6pt 0;line-height:1.1;border:0;white-space:pre-wrap;}code{font-family:APLFont, monospace;line-height:1.2;font-size:9pt;padding:3pt 1pt 3pt 1pt;color:#950000;padding:3pt 4pt 3pt 4pt;}tbody th, tfoot tr{background-color:#e6e6e6;}tbody tr:nth-child(even){background-color:#fafafa;}th{background-color:#F0F0F0;}th, td{padding:1pt 5pt;border:1px solid #E3E3E3;vertical-align:top;}table td + td{border-left:1px solid gray;}table th + th{border-left:1px solid gray;}table code{font-style:normal;padding-left:0;padding-right:0;}table{margin:1.5em 0;font-family:APLFont;font-size:9pt;padding:0;border:1pt solid silver;border-collapse:collapse;}li > table{margin:10pt 0 10pt 0;}tr{margin:20pt;}th{font-weight:bold;}tfoot td{font-weight:bold;}blockquote{border-left:5pt solid silver;padding-left:5pt;margin:8pt 3pt 8pt 8pt;}nav{background-color:#f8f8f8;border:1pt solid Gray;width:auto;float:right;padding:5pt 5pt 5pt 0;margin:5pt 0 5pt 5pt;page-break-inside:avoid;break-inside:avoid;clear:both;overflow:hidden;}nav *{font-size:75%;}nav ul{list-style-type:none;margin:0 0 2pt 0;padding:0;}nav ul li{margin-bottom:0;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{font-size:9pt;line-height:1;padding:0;margin-top:0;margin-bottom:0;margin-left:8pt;}dl{margin-top:0;margin-bottom:10pt;}dt{margin-top:10pt;margin-bottom:0;font-weight:800;page-break-inside:avoid;}dd{margin-top:2pt;}label#hide_toc_label{font-size:65%;}.toc-container{position:relative;height:auto;margin-top:2pt;background-color:inherit;}.toc-container h3{margin:0 0 2pt 7pt;}[type="checkbox"]{display:none;}label{display:block;width:100%;height:1.1em;top:0;padding-left:10pt;}label:before{content:'Table of contents';font-weight:bold;font-size:140%;padding-bottom:10pt;}a.external_link::before{content:" 🌎";}a.bookmark_link::before{content:" ➯";}a.mailto_link::before{content:" ✉"}nav a.bookmark_link{font-style:normal;}nav p{margin-left:10pt;font-weight:bold;font-size:9pt;}nav a{font-style:normal;}nav a.bookmark_link::before{content:"";}div#footnotes_div a::before{content:"";}div#footnotes_div a{font-style:normal;}div#footnotes_div{page-break-inside:avoid;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("http://misc.aplteam.com/apl385.ttf") format("truetype");}.no_print{display:none;}.red{color:red;}.center{text-align:center;margin:0 auto;}.left{text-align:left;margin-right:0 auto;}.right{text-align:right;margin-left:0 auto;}.avoid_page_break{page-break-inside:avoid;}.page_break_before{page-break-before:always;}div.leanpub{margin:10pt 0 10pt 8pt;page-break-inside:avoid;}div.leanpub_A{border:1pt solid black;background-color:#f9f9f9;padding:5pt;margin:10pt 0 10pt 0;page-break-inside:avoid;}div.leanpub h3, div.leanpub_A h3{font-size:1.2em;padding:3pt 0 0 0;margin:0;}div.leanpub h4, div.leanpub_A h4{font-size:1.1em;padding:3pt 0 0 0;margin:0;}div.leanpub h5, div.leanpub h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub_A h5, div.leanpub_A h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub img{padding:0;margin:0 10pt 2pt 0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub > div > h1:first-child{padding-top:5pt;}div.leanpub img{float:left;padding:0;margin:5pt 10pt 0 0;clear:both;}div.leanpub p{padding:3pt 0 0 0;margin:0;}span.leanpub_code{font-weight:bold;}div.leanpub p{display:block;padding:8pt 0 0 0;}div.leanpub > div{margin-left:35pt;}sup{font-size:0.75em;line-height:0;position:relative;vertical-align:baseline;top:-0.4em;}
</style>
<meta name="author" content="kai">
</head>
<body>
<div class="h_tag">
<a href="#Test-framework-for-Unit-tests-in-Dyalog-APL" id="Test-framework-for-Unit-tests-in-Dyalog-APL" class="autoheader_anchor">
<h1 data-id="Test-framework-for-Unit-tests-in-Dyalog-APL">Test framework for Unit tests in Dyalog APL</h1>
</a>
</div>
<p><code>Tester2</code> is a member of the APLTree library. This library is a collection of classes etc. that aim to support the Dyalog APL programmer. Search GitHub for “apltree” and you will find solutions to many every-day problems Dyalog APL programmers might have to solve.</p>
<p><strong><em>Note:</em></strong> <code>Tester2</code> is the successor of the <code>Tester</code> class. Although it has inherited the general ideas and concepts from the <code>Tester</code> class the new <code>Tester2</code> class has a very different workflow. Methods have been removed, added and renamed. It was therefore decided to start fresh with a new class.</p>
<p><code>Tester</code> was created roughly 10 years ago. Although it's solved its purpose technology has advanced. Also, during all these years a couple of design problems <code>Tester</code> was suffering from raised their heads. <code>Tester2</code> is an attempt to integrate (almost) latest technology (version 16.0 of Dyalog APL) and to overcome those aforementioned design obstacles.</p>
<div class="h_tag">
<a href="#Overview" id="Overview" class="autoheader_anchor">
<h2 data-id="Overview">Overview</h2>
</a>
</div>
<p>The purpose of this class is to provide a framework for testing all the projects of the APLTree library. Only with such a framework is it possible to make changes to any APLTree project with confidence.</p>
<p>You might find the framework flexible enough to suit your own needs when it comes to implementing tests, even independently from the APLTree project.</p>
<p>Depending on how the Test framework is used it might or might not present a GUI. Note that the GUI is a Windows-only feature (for the time being) although in all other respects <code>Tester2</code> works on all platforms; if you decide to avoid the GUI, messages of any kind are printed to the Dyalog session window.</p>
<p>If the GUI shows that's how it looks like:</p>
<p><img src="gui_1.png" alt="The messages" title="The messages"></p>
<p>The “Log” tab shows all the messages the <code>Tester2</code> class provides:</p>
<ul>
<li>Whether there were any INI files instantiated</li>
<li>Whether a function  <code>Initial</code> was found and executed</li>
<li>Which test cases got examined and possibly executed</li>
<li>What the overall picture is:
<ul>
<li>Number of test cases executed</li>
<li>Number of test cases that crashed</li>
<li>Number of test cases that failed</li>
<li>Number of test cases that were inactive</li>
<li>Number of test cases that were not applicable</li>
<li>Number of test cases that are designed to run on different platforms</li>
</ul></li>
<li>Whether  a function  <code>Cleanup</code> was found and executed</li>
</ul>
<p>The “Details” tab shows a list of all test cases with…</p>
<ol start="1">
<li>the status in the first column</li>
<li>the name (but without <code>Test_</code>) in the second column</li>
<li>the first comment line in the third column</li>
<li>the symbolic name of the return code, like <code>Failed</code> or <code>WindowsOnly</code> etc. in the fourth column.</li>
</ol>
<p><img src="gui_2.png" alt="This list" title="The list"></p>
<p>The status column shows:</p>
<ul>
<li><code>✓</code> okay</li>
<li><code>*</code> failed</li>
<li><code>#</code> broken</li>
<li><code>⍝</code> inactive</li>
</ul>
<p>Different status show in different colours.</p>
<p>After all test cases got processed the user might interact with the GUI. These are the commands presented by the context menu:</p>
<p><img src="gui_3.png" alt="Context menu" title="Context menu"></p>
<p>Note that all <code>Run*</code> functions return a two-element vector:</p>
<ol start="1">
<li>[1] is a return code (<code>rc</code>) with 0 for “okay”.</li>
<li>[2] is an empty vector in case <code>rc</code> is 0 and might contain additional information in case <code>rc</code> is not 0.</li>
</ol>
<p>A reference pointing to the GUI is assigned internally. That's why the GUI does not disappear straight away after all test cases have been executed. To get rid of it either click the “Close” box or call the <code>T.CloseGUI</code> method which does not require an argument.</p>
<div class="h_tag">
<a href="#Differences-between-Tester-and-Tester2" id="Differences-between-Tester-and-Tester2" class="autoheader_anchor">
<h2 data-id="Differences-between-Tester-and-Tester2">Differences between <code>Tester</code> and <code>Tester2</code></h2>
</a>
</div>
<p>Since <code>Tester2</code> is supposed to replace <code>Tester</code> without being 100% compatible it is probably worthwhile to see the main differences on a glance because the two are pretty similar, and if you've used <code>Tester</code> you probably want to convert your tests to <code>Tester2</code>.</p>
<div class="h_tag">
<a href="#Tester2-needs-to-be-instantiated" id="Tester2-needs-to-be-instantiated" class="autoheader_anchor">
<h3 data-id="Tester2-needs-to-be-instantiated"><code>Tester2</code> needs to be instantiated.</h3>
</a>
</div>
<p>While <code>Tester</code> offered a function <code>EstablisHelpersIn</code> which injected a significant number of functions into the namespace that hosts test cases <code>Tester2</code> <em>must</em> be instantiated.</p>
<p>All methods and all symbolic names are available via the the instance, and only via the instance. Therefore:</p>
<pre><code>      T←⎕NEW Tester2 HomeOfYourTestCases
      ⊃⍴T.⎕nl -3
24
      ⊃⍴T.⎕nl -2
13</code></pre>
<p>The advantage is that your namespace is not cluttered with those methods and symbolic names. The disadvantage is that you must use the instance name now.</p>
<div class="h_tag">
<a href="#Symbolic-names-got-renamed" id="Symbolic-names-got-renamed" class="autoheader_anchor">
<h3 data-id="Symbolic-names-got-renamed">Symbolic names got renamed</h3>
</a>
</div>
<p>In <code>Tester</code> all symbolic names started with a <code>∆</code> character.</p>
<p>In <code>Tester2</code> they start with an underscore (<code>_</code>). This is a very common convention for symbolic names (or constants) and was therefore adapted.</p>
<div class="h_tag">
<a href="#Custom-constants-added" id="Custom-constants-added" class="autoheader_anchor">
<h3 data-id="Custom-constants-added">Custom constants added</h3>
</a>
</div>
<p>In addition to the pre-defined symbolic names you can define your own ones; see <a href="#custom-constants" class="bookmark_link">Custom constants</a> for details.</p>
<div class="h_tag">
<a href="#Couple-of-helpers-have-been-renamed" id="Couple-of-helpers-have-been-renamed" class="autoheader_anchor">
<h3 data-id="Couple-of-helpers-have-been-renamed">Couple of helpers have been renamed</h3>
</a>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;"> Old name </th>
<th style="text-align: left;"> New name              </th>
</tr>
</thead>
<tbody>
<tr>
<td><code>E</code></td>
<td><code>T.EditTestFunctions</code></td>
</tr>
<tr>
<td><code>L</code></td>
<td><code>T.ListTestFunctions</code></td>
</tr>
<tr>
<td><code>G</code></td>
<td><code>T.ListGroups</code></td>
</tr>
</tbody>
</table>
<div class="h_tag">
<a href="#INI-files" id="INI-files" class="autoheader_anchor">
<h3 data-id="INI-files">INI files</h3>
</a>
</div>
<p>When <code>Tester</code> found one or two INI files they were merged, converted into a single flat namespace holding variables, and that namespace was created in the hosting namespace as <code>INI</code>.</p>
<p>With <code>Tester2</code> you won't be surprised to learn that the INI file is now part of the instance. With an instance <code>T</code> you can address a variable <code>foo</code> as <code>T.INI.foo</code>.</p>
<div class="h_tag">
<a href="#The-Run-functions" id="The-Run-functions" class="autoheader_anchor">
<h3 data-id="The-Run-functions">The <code>Run*</code> functions</h3>
</a>
</div>
<p>The number of <code>Run*</code> functions has be reduced, but at the same time a general function <code>Run__</code> is now available that can be used for all possible scenarios.</p>
<div class="h_tag">
<a href="#The-result-of-the-Run-functions" id="The-result-of-the-Run-functions" class="autoheader_anchor">
<h3 data-id="The-result-of-the-Run-functions">The result of the <code>Run*</code> functions</h3>
</a>
</div>
<p>With <code>Tester2</code> all <code>Run*</code> function return 0, 1 or 2 as return code:</p>
<ul>
<li><code>0</code> means that all test cases that got actually executed returned <code>_OK</code>.</li>
<li><code>1</code> means that at least one test function either crashed or returned <code>_Failed</code>.</li>
<li><code>2</code> means that a function <code>Initial</code> was found and exected but failed to return a 0, meaning it could not initialize.</li>
</ul>
<div class="h_tag">
<a href="#Cleanup-function-may-accept-a-right-argument" id="Cleanup-function-may-accept-a-right-argument" class="autoheader_anchor">
<h3 data-id="Cleanup-function-may-accept-a-right-argument"><code>Cleanup</code> function may accept a right argument</h3>
</a>
</div>
<p>In <code>Tester</code> the function <code>Cleanup</code> was expected to be niladic. With <code>Tester2</code> it may be monadic.</p>
<div class="h_tag">
<a href="#Initialising-on-a-per-group-basis" id="Initialising-on-a-per-group-basis" class="autoheader_anchor">
<h3 data-id="Initialising-on-a-per-group-basis">Initialising on a per-group basis</h3>
</a>
</div>
<p>In addition to the <a href="#initialisation" class="bookmark_link">global <code>Initial</code> function</a> you can also have <a href="#initialisation-for-groups" class="bookmark_link">group-specific <code>Initial</code> functions</a>, a feature that was not available with <code>Tester</code>.</p>
<p>A function is recognized as a group-specific <code>Initial</code> function by naming convention: for a group <code>Foo</code> the function's name must be <code>Initial_Foo</code> for it to be recognized.</p>
<div class="h_tag">
<a href="#The-List-function-got-renamed" id="The-List-function-got-renamed" class="autoheader_anchor">
<h3 data-id="The-List-function-got-renamed">The <code>List</code> function got renamed</h3>
</a>
</div>
<p>When a parameter namespace is created by calling the instance method <code>CreateParms</code> it comes with a built-in function <code>List</code>. In <code>Tester</code> the name of that function was <code>∆List</code>.</p>
<div class="h_tag">
<a href="#New-method-QuitTests" id="New-method-QuitTests" class="autoheader_anchor">
<h3 data-id="New-method-QuitTests">New method <code>QuitTests</code></h3>
</a>
</div>
<p><code>Tester</code> did not offer a way to quit from a test suite after having executed only a subset of the test functions, for example after a test function breaks and you don't want to continue.</p>
<p><code>Tester2</code> offers the method <code>QuitTests</code> for this purpose. When executed it prints a <code>⎕SIGNAL</code> command to the session that when executed will make <code>Tester2</code> finish the currently running tests in an orderly fashion, including executing any <code>Cleanup</code> function.</p>
<div class="h_tag">
<a href="#Details" id="Details" class="autoheader_anchor">
<h2 data-id="Details">Details</h2>
</a>
</div>
<div class="h_tag">
<a href="#Terminology" id="Terminology" class="autoheader_anchor">
<h3 data-id="Terminology">Terminology</h3>
</a>
</div>
<p>Note that test cases causing a crash are considered “broken”. Test cases that do not return the expected result are considered “failing”.</p>
<div class="h_tag">
<a href="#Assumptions-and-preconditions" id="Assumptions-and-preconditions" class="autoheader_anchor">
<h3 data-id="Assumptions-and-preconditions">Assumptions and preconditions</h3>
</a>
</div>
<ol start="1">
<li>The <code>#.Tester2</code> class assumes that all your tests are hosted by a namespace. It may be an ordinary (recommended) or a scripted namespace, but it must not be an unnamed namespace.</li>
<li>You must create an instance of the <code>Tester2</code> class in order to do anything useful. This is <em>the</em> major difference to the now deprecated <code>Tester</code> class.
<p>The constructor demands a right argument: that must be a reference to the namespace that hosts all your test cases.</p>
<p>Example: given that all your test cases live in <code>Foo</code> then you could create an instance <code>T</code> with: <code>T←⎕NEW Tester2 Foo</code></p></li>
<li>All test functions inside their namespace are expected to start their names with <code>Test_</code> followed either by some digits or a group name followed by an underscore followed by some digits, for example <code>Test_Foo_003</code>.
<p>It is recommended that in case you use groups you assign <em>all</em> your test cases to groups.</p></li>
<li>The number of digits you use for numbering is not restricted: <code>Test_foo_1</code> is fine, and so is <code>Test_foo_0000001</code>. However, they should be consistent, at least within a group.</li>
<li>In each test function the first line after the header must carry a comment telling what is actually tested.
<p>Keep in mind that later this is the only way to tell one test case from the others without reading the code, so be as clear as you can possibly be.</p>
<p>You are restricted to a single line, and you should keep it short enough to be displayed with a reasonably setting of <code>⎕PW</code>.</p></li>
</ol>
<div class="h_tag">
<a href="#Executing-test-cases" id="Executing-test-cases" class="autoheader_anchor">
<h3 data-id="Executing-test-cases">Executing test cases</h3>
</a>
</div>
<p>There are some typical scenarios:</p>
<ul>
<li>Run all test cases, with or without error trapping and with or without stop flag: see the function <code>Run</code>.</li>
<li>Run only a limited selection of all test cases,  with or without error trapping and with or without stop flag: see the function <code>RunThese</code>.</li>
<li>Run only “batchable” test cases, with or without error trapping and with or without stop flag: see the function <code>RunBatchTests</code>.</li>
<li>Run all test cases with a GUI, with or without error trapping and with or without stop flag: see the function <code>RunGUI</code>.</li>
</ul>
<p>All these functions call <code>Run__</code>, which means that this is a generalized all-singing all-dancing function. If none of the above functions fulfil your needs you can call <code>Run__</code> yourself.</p>
<p>Definitions:</p>
<div class="h_tag">
<a href="#Error-trapping" id="Error-trapping" class="autoheader_anchor">
<h4 data-id="Error-trapping">Error trapping (<code>trapFlag</code>)</h4>
</a>
</div>
<p>Traps all errors except that is does not influence the workings of the <code>debugFlag</code>.</p>
<div class="h_tag">
<a href="#Debugging" id="Debugging" class="autoheader_anchor">
<h4 data-id="Debugging">Debugging (<code>debugFlag</code>)</h4>
</a>
</div>
<p>If this flag is 0 any failing test within any test function just makes the test function quit, returning a return code that has the symbolic name <code>_Failure</code>. See <a href="#symbolic-names" class="bookmark_link">Symbolic names</a> for details.</p>
<p>If this is 1 then any failing check crashes right on the spot. This allows one to investigate what went wrong, and why.</p>
<div class="h_tag">
<a href="#Suspend-execution" id="Suspend-execution" class="autoheader_anchor">
<h4 data-id="Suspend-execution">Suspend execution (<code>stopFlag</code>)</h4>
</a>
</div>
<p>If set this makes the test framework stop just before any test function is about to be executed. This allows you to trace any test cases from top to bottom.</p>
<div class="h_tag">
<a href="#Batchable-tests" id="Batchable-tests" class="autoheader_anchor">
<h4 data-id="Batchable-tests">Batchable tests</h4>
</a>
</div>
<p>These are tests that do not need a human in front of the monitor. Ideally all tests should be “batchable” of course. However, in real life this is not always possible for technical reasons, or the effort would be way too high.</p>
<p>Note that all test cases get the <code>batchFlag</code> provided as part of the right argument, so they know what's required.</p>
<div class="h_tag">
<a href="#The-syntax-of-test-functions" id="The-syntax-of-test-functions" class="autoheader_anchor">
<h3 data-id="The-syntax-of-test-functions">The syntax of test functions</h3>
</a>
</div>
<ol start="1">
<li>Every test function must accept a right argument which is a two-item vector of Booleans:
<ol start="1">
<li><code>debugFlag</code>; 1 means that the test function runs in debug mode.
<p>Assuming that all tests use the <a href="#flow-control" class="bookmark_link">flow control functions</a> provided by <code>Tester2</code> the difference is that with <code>debugFlag</code> being 0 the test function would finish and return the symbolic name <code>Failure</code> while with <code>debugFlag</code> being 1 the test function would crash on the spot when a particular check fails, allowing the user to investigate right away.</p></li>
<li><code>batchFlag</code>: 1 means that there is no user available in front of the monitor.
<p>That allows a test function that requires a human for confirmation or some action to <em>not</em> carry out the test but return the symbolic name <code>_NoBatchTest</code>.</p></li>
</ol></li>
<li>Every test function must return a result. You are advised to assign one of the symbolic names defined as read-only fields every instance of <code>Tester2</code> comes with. This is much more readable than a simple integer, and it is easier to find as well. See <a href="#symbolic-names" class="bookmark_link">Symbolic names</a> for details.</li>
</ol>
<div class="h_tag">
<a href="#Groups" id="Groups" class="autoheader_anchor">
<h3 data-id="Groups">Groups</h3>
</a>
</div>
<p>You will find that test cases need to be kept simple, and should not depend on each other (see <a href="#best-practices" class="bookmark_link">Best Practices</a>). That leads easily to a significant number of test cases in case of a complex subject like, say, MarkAPL ().</p>
<p>It is pretty easy to get lost in a large number of test cases, less so when writing the first ones but more so when later you need to delete obsolete test cases, add new test cases for new features or fixed bugs and make changes to test cases that need, well, changing.</p>
<p>That's why groups are quite important: they allow you to order test cases hierarchically.</p>
<p>It is also possible to execute all test cases belonging to a particular group with a single command.</p>
<p>Note that you can have group-specific <a href="#initialisation-for-groups" class="bookmark_link">initialization</a> and <a href="#cleaning-up-for-groups" class="bookmark_link">cleaning up</a>.</p>
<div class="h_tag">
<a href="#Custom-constants" id="Custom-constants" class="autoheader_anchor">
<h3 data-id="Custom-constants">Custom constants</h3>
</a>
</div>
<p>Although there are quite a number of symbolic names available to give feedback for many foreseeable problems (like a test that can run only on a certain platform,) there will always be circumstances that cannot be foreseen. Therefore <code>Tester2</code> allows you to define up to 9 custom constants.</p>
<p>Custom constants are named from <code>custom_1</code> to <code>custom_9</code>. They are initialized with <code>''</code>. In order to use one you must assign a simple character vector. This character vector is shown in the “Result” column of the GUI etc.</p>
<p>An example would be (assuming that <code>T</code> is an instance of the <code>Tester2</code> class):</p>
<pre><code>T.custom_1←'Invalid version of Dyalog APL'</code></pre>
<div class="h_tag">
<a href="#Checks-before-and-after-a-test-case-is-executed" id="Checks-before-and-after-a-test-case-is-executed" class="autoheader_anchor">
<h3 data-id="Checks-before-and-after-a-test-case-is-executed">Checks before and after a test case is executed</h3>
</a>
</div>
<div class="h_tag">
<a href="#Application" id="Application" class="autoheader_anchor">
<h4 data-id="Application">Application</h4>
</a>
</div>
<p>Imagine that a few of a large set of test cases leave files behind in the temp folder, and you have no idea which ones. Obviously that is easy to find out when you check right after a test case was executed.</p>
<p>That's why <code>exec_before_each_test</code> and <code>exec_after_each_test</code> were added as properties with version 1.1 to <code>Tester2</code>: they allow you to check whatever you want either just before or right after a test case was executed.</p>
<p>Another application is when a test case causes a sys error (aplcore) but it is not that particular test case that is causing the real problem but an earlier one. In that case you can execute <code>2 ⎕NQ'.' 'wscheck'</code> after each test case, forcing the interpreter to perform a workspace integrity check.</p>
<div class="h_tag">
<a href="#Overview-1" id="Overview-1" class="autoheader_anchor">
<h4 data-id="Overview-1">Overview</h4>
</a>
</div>
<p>When specified they must be the fully qualified name of a monadic function that may or may not return a result.</p>
<p>The right argument will be a two-element vector:</p>
<ol start="1">
<li>The name of the test function that is about to be executed (in case of <code>exec_before_each_test</code>) or was just executed (in case of <code>exec_after_each_test</code>).</li>
<li>A namespace with all the parameters.</li>
</ol>
<p>Regarding the result there are two options:</p>
<ul>
<li>In case no result is returned you need to make sure you make the function stop in case you find something not to your liking, or print a message to the session if that's sufficient.</li>
<li>In case the function returns a result it must be a text vector. If that text vector is empty then <code>Tester2</code> does not take any action. If it is a simple string this string will be printed to the session. Then <code>Tester2</code> carries on.</li>
</ul>
<div class="h_tag">
<a href="#Work-flow" id="Work-flow" class="autoheader_anchor">
<h2 data-id="Work-flow">Work flow</h2>
</a>
</div>
<p>No matter which of the <code>Run*</code> functions you are going to call, the workflow is always the same. (There is a minor difference when <code>Run__</code> is used; this will be discussed later)</p>
<div class="h_tag">
<a href="#Create-an-instance" id="Create-an-instance" class="autoheader_anchor">
<h3 data-id="Create-an-instance">Create an instance</h3>
</a>
</div>
<p>First you need an instance. Let's assume that you have a project in <code>#.Foo</code> and that the project's test cases are hosted by the namespace <code>#.Foo.TestCases</code>. You create an instance with:</p>
<pre><code>      T←⎕NEW #.Tester2 #.Foo.TestCases</code></pre>
<p>From then on, all <code>Run*</code> functions, all symbolic names and all other helpers are available via the instance <code>T</code>. Some examples:</p>
<pre><code>      T.RunGUI ⍬
      T._OK
      T.PassesIf
      T.⎕nl -3    ⍝ Produces a list of all public instance methods</code></pre>
<p>When you call one of the <code>Run*</code> functions the same steps are executed:</p>
<div class="h_tag">
<a href="#INI-files-1" id="INI-files-1" class="autoheader_anchor">
<h3 data-id="INI-files-1">INI files (optional)</h3>
</a>
</div>
<p>Note that there is an instance property <code>IniFolder</code>. By default this points to <code>AcreConfig.ProjectFolder</code> if a namespace <code>AcreConfig</code> can be found in the namespace that hosts the test cases or one of it's parents up to the <code>#</code> namespace.</p>
<p>If there is no such namespace the default falls back to the current directory.</p>
<p>If your INI file(s) do not live in either place then you must set the <code>IniFolder</code> property in order to allow <code>Tester2</code> to find the INI file(s).</p>
<p>First the <code>Run*</code> methods check whether there is a file <code>testcases.ini</code>. If this is the case that INI file is processed. Use this INI file to specify general stuff that does not depend on a certain computer/environment.</p>
<p>Then the <code>Run*</code> methods checks for a file <code>testcases-{computername}.ini</code>. If this file exists it is processed. Use this to specify stuff that does depend on a certain computer or environment.</p>
<p>Note that if one or both of the two INI files exist there will be a <em>flat</em> namespace <code>{yourTestNamespace}.INI</code>, meaning that any sections defined in the INI file(s) will be ignored.</p>
<p>An example: if your test functions are hosted by a namespace <code>Foo.TestCases</code> and your INI file specifies a variable <code>hello</code> as holding “world” and you have created an instance with the name <code>T</code> inside <code>#.Foo.TestCases</code> then:</p>
<pre><code>       'world'≡#.Foo.TestCases.T.INI.hello
1</code></pre>
<div class="h_tag">
<a href="#Initialisation" id="Initialisation" class="autoheader_anchor">
<h3 data-id="Initialisation">Initialisation</h3>
</a>
</div>
<p>In the next step the <code>Run*</code> method checks whether there is a function <code>Initial</code> in the hosting namespace. If that is the case then this function is executed.</p>
<p>Note that the function must be either niladic or monadic, and it may return no result at all or a Boolean result. A 1 means that function did what it is supposed to do (=same as no result) while a 0 means it could not initialize (success flag).</p>
<p>Of course, you can simply execute <code>→</code> on a single line in your <code>Initial</code> function if any requirement is not met, but that would also mean that if you run your test cases automatically as part of, say, an automated build process then this would disrupt the workflow.</p>
<p>In such cases <code>Initial</code> should return a 0 indicating failure. Also, part of the initialization might have been carried out, and a function <code>Cleanup</code> (discussed in a second) might get rid of any left-overs.</p>
<p>If the function is monadic then a reference pointing to the parameter space is passed as the right argument. By checking this parameter space <code>Initial</code> can, for example, find out whether the <code>batchFlag</code> is set or not.</p>
<p>You may also put a variable inside that namespace which can later be referenced by the <code>Cleanup</code> function. However, in order to avoid name clashes you are advised to start the names of such variables with a <code>⍙</code> or a <code>∆</code> character.</p>
<p>Use <code>Initial</code> to create stuff that's needed by <strong>all</strong> test cases, or tell the user something important (only if the batch flag is false of course).</p>
<p>Note that you can have separate <a href="#initialisation-for-groups" class="bookmark_link"><code>Initial</code> functions for specific or all groups</a>. Use this to initialize stuff that is only needed for a certain group, like a database connection etc.</p>
<p>When everything else has been done then <code>Tester2</code> looks for a function <code>Cleanup</code> in the hosting nanmespace. If there is such a function it will be executed.</p>
<div class="h_tag">
<a href="#Initialisation-for-groups" id="Initialisation-for-groups" class="autoheader_anchor">
<h3 data-id="Initialisation-for-groups">Initialisation for groups</h3>
</a>
</div>
<p>You can have initialisation functions for groups. It's recognzied by naming convention: for a group <code>foo</code> the function's name must be <code>Initial_foo</code>.</p>
<p>The rules are exactly the same as for the <a href="#initialisation" class="bookmark_link">global <code>Initial</code> function</a>, although the consequences are different:</p>
<p>When <code>Initial_foo</code> returns a Boolean and that is a zero, then no test function belonging to the group <code>foo</code> will be executed but <code>Tester2</code> will carry on executing other test cases.</p>
<div class="h_tag">
<a href="#Finally-running-the-test-cases" id="Finally-running-the-test-cases" class="autoheader_anchor">
<h3 data-id="Finally-running-the-test-cases">Finally: running the test cases</h3>
</a>
</div>
<p>Now the test cases are executed one by one, or, if groups are defiend, one group after the other.</p>
<div class="h_tag">
<a href="#Cleaning-up" id="Cleaning-up" class="autoheader_anchor">
<h3 data-id="Cleaning-up">Cleaning up</h3>
</a>
</div>
<p>After the last test case was executed the <code>Run*</code> function checks whether there is a function <code>Cleanup</code> in the namespace hosting your test cases. If that's the case then this function is executed.</p>
<p>Any <code>Cleanup</code> function should either return a shy result (which will be inored) or no result at all. It might accept a right argument, but this is optional: it might as well be niladic. If it <em>does</em> accept a right argument it will get the parameter namespace passed.</p>
<p>Note that a function <code>Cleanup</code> would be executed no matter whether there was or was not a function <code>Initial</code>, and if there was, no matter whether it returned a 0 or a 1 or nothing at all.</p>
<div class="h_tag">
<a href="#Cleaning-up-for-groups" id="Cleaning-up-for-groups" class="autoheader_anchor">
<h3 data-id="Cleaning-up-for-groups">Cleaning up for groups</h3>
</a>
</div>
<p>You can have clean-up functions for groups. It's recognzied by naming convention: for a group <code>foo</code> the function's name must be <code>Cleanup_foo</code>.</p>
<p>The rules are exactly the same as for the <a href="#initialisation" class="bookmark_link">global <code>Cleanup</code> function</a>.</p>
<p>Naturally a group-specific <code>Cleanup</code> function is called after the last test function of that group got executed.</p>
<div class="h_tag">
<a href="#INI-file-again" id="INI-file-again" class="autoheader_anchor">
<h3 data-id="INI-file-again">INI file again</h3>
</a>
</div>
<p>Finally, the namespace <code>INI</code> holding variables populated from your INI file(s) is removed from the instance.</p>
<div class="h_tag">
<a href="#Premature-exit" id="Premature-exit" class="autoheader_anchor">
<h3 data-id="Premature-exit">Premature exit</h3>
</a>
</div>
<p>There might be situations when you've executed some but not all test cases and now you want to exit the test framework, typically while you are in a test function. In such a case the framework should clean up (execute any <code>Cleanup</code> function etc.)</p>
<p>This can be achieved by calling the instance method <code>QuitTests</code>. This function signals a <code>QuitEvent</code> which is trapped and processed in a specific way by the test framework.</p>
<p>Note that setter and getter functions of any properties are <em>not</em> covered.</p>
<div class="h_tag">
<a href="#Code-coverage" id="Code-coverage" class="autoheader_anchor">
<h2 data-id="Code-coverage">Code coverage</h2>
</a>
</div>
<p>Since version 2.3 <code>Tester2</code> offers optionally information regarding code coverage: it reports all functions and operators that are …</p>
<ul>
<li>not called at all</li>
<li>covered 100% by tests</li>
<li>called but not all lines got executed</li>
</ul>
<p>Note that <code>Tester2</code> tries to be smart: it does not count any lines that…</p>
<ul>
<li>are empty</li>
<li>carry only a comment</li>
<li>carry only a control structur like <code>:Access</code>, <code>:Else</code>, all flavours of <code>:End*</code> and others that cannot in any meaningful way be “tested”.</li>
</ul>
<p>Note that private functions and operators in classes are covered as well.</p>
<p>For that to work you must specify the <code>watch</code> property: this holds the name of a class script or a namespace, or several of them as a simple text vector, separated by commas.</p>
<div class="h_tag">
<a href="#Restrictions" id="Restrictions" class="autoheader_anchor">
<h3 data-id="Restrictions">Restrictions</h3>
</a>
</div>
<ul>
<li>Properties contain at least a getter and may contain a setter, functions used to retrieve or set data. Such functions are not covered by <code>Tester2</code>.</li>
<li>At the time of writing Dyalog provides an <code>⌶</code> function for retrieving code for functions and operators, including private functions, but it does not offer any help for analyzing a script in order to extract the names of all such functions.
<p>For that to work <code>Tester2</code> relies on the code to be formatted properly. For example, in order to tell any <code>∇</code> that is used for recursive calls in a dfn from a <code>∇</code> that functions as opening or closing tag for a traditional function the number of leading spaces counts.</p></li>
<li>Unnamed dfns that stretch over more than one line are not recognized as such and therefore not ignored. The ressources it would take to solve this seemed not to be justified.
<p>Therefore, this code:</p>
<pre><code>result←{
    +/⍳≢⍵
}1 2 3</code></pre></li>
<p>  would incorrectly be identified as a dfn `result`. Note however, that</p>
<p>  ```</p>
<p>  result←{+/⍳≢⍵}1 2 3</p>
<p>  ```</p>
<p>  would correctly be ignored.</p>
</ul>
<div class="h_tag">
<a href="#Instance-stuff-offered-by-Tester2" id="Instance-stuff-offered-by-Tester2" class="autoheader_anchor">
<h2 data-id="Instance-stuff-offered-by-Tester2">Instance stuff offered by <code>Tester2</code></h2>
</a>
</div>
<p>The methods fall into four groups:</p>
<div class="h_tag">
<a href="#Running-test-cases" id="Running-test-cases" class="autoheader_anchor">
<h3 data-id="Running-test-cases">Running test cases</h3>
</a>
</div>
<p><code>Run</code>, <code>RunBatchTests</code>, <code>RunGUI</code>, <code>RunThese</code> and <code>Run__</code> are running all or selected test cases with or without error trapping.</p>
<div class="h_tag">
<a href="#Flow-control" id="Flow-control" class="autoheader_anchor">
<h3 data-id="Flow-control">Flow control</h3>
</a>
</div>
<p><code>FailsIf</code>, <code>PassesIf</code> and <code>GoToTidyUp</code> control the program flow in test functions. The test template (see <a href="#test-function-template" class="bookmark_link"><code>GetTestTemplate</code></a> for details) contains examples for how to use these functions.</p>
<p>These functions return a result (Boolean) in case <code>debugFlag</code> is a 0 but make the calling <code>Test_*</code> function crash otherwise, allowing you to investigate a failing test case right on the spot. Note that the setting of the <code>trapFlag</code> has no bearing on this.</p>
<p>This is achieved by the functions <code>FailsIf</code>, <code>PassesIf</code> and <code>GoToTidyUp</code> signalling an error 999 that can be trapped with, say:</p>
<pre><code>      ⎕TRAP←(999 'C' '∘∘∘ ⍝ Deliberate error')(0 'N')</code></pre>
<p>That's why the template for a test function carries such a statement <em>and</em> keeps <code>⎕TRAP</code> local.</p>
<p>Note that <code>GoToTidyUp</code> allows you to jump to a label <code>_TidyUp</code> with a statement like:</p>
<pre><code> →GoToTidyUp ~expected≡result</code></pre>
<p>This is useful in case a test case needs to do some cleaning up like deleting a temporary file created by the test case, so just jumping out is not an option In case the right argument is 1 (rather than 0) it causes a crash in debug mode and carries out the jump otherwise.</p>
<div class="h_tag">
<a href="#Test-function-template" id="Test-function-template" class="autoheader_anchor">
<h3 data-id="Test-function-template">Test function template</h3>
</a>
</div>
<p>You can get a test function template by calling the instance method <code>GetTestTemplate</code>.</p>
<p>You must provide a number as right argument. The test function will be named <code>Test_{yourNumber}</code>. The number must be between 1 and 999 and will be formatted to a three-character vector.</p>
<p>You can also provide a group name via the optional left argument.</p>
<p>Check the examples which assume that an instance of <code>Tester2</code> is available as <code>T</code>, and that you are inside the (ordinary, non-scripted) namespace that hosts the test cases:</p>
<pre><code>      ⊃⍴'T'⎕NL 3
0
      T.GetTestTemplate 3
Test_003
     ⊃⍴'T'⎕NL 3
1
      'Misc' T.GetTestTemplate 1
Test_Misc_001
     ⊃⍴'T'⎕NL 3
2</code></pre>
<p>Note that in case such a test function already exists it will be overwritten, but first you will be prompted for confirmation.</p>
<p>Note that for technical reasons such a template function cannot be established by <code>GetTestTemplate</code> when the namespace hosting the test cases is scripted. If that is the case you will be prompted for copying the code to the clipboard; it is then up to you to insert the code into the script.</p>
<div class="h_tag">
<a href="#Symbolic-names" id="Symbolic-names" class="autoheader_anchor">
<h3 data-id="Symbolic-names">Symbolic names</h3>
</a>
</div>
<p>These are the public read-only instance fields that act like constants:</p>
<table>
<thead>
<tr>
<th style="text-align: left;"> Name                  </th>
<th style="text-align: left;"> Meaning                                                                     </th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_OK</code></td>
<td>Passed</td>
</tr>
<tr>
<td><code>_Failed</code></td>
<td>Unexpected result</td>
</tr>
<tr>
<td><code>_NoBatchTest</code></td>
<td>Not executed because <code>batchFlag</code> was 1.</td>
</tr>
<tr>
<td><code>_NotApplicable</code></td>
<td>This test is not applicable here and now</td>
</tr>
<tr>
<td><code>_NotImplemented</code></td>
<td>Attempts to test a feature that has yet not been implemented</td>
</tr>
<tr>
<td><code>_InActive</code></td>
<td>Not executed because the test case is inactive (not ready, buggy, …)</td>
</tr>
<tr>
<td><code>_LinuxOnly</code></td>
<td>Not executed because runs under Linux only</td>
</tr>
<tr>
<td><code>_LinuxOrMacOnly</code></td>
<td>Not executed because runs under Linux/Mac OS only</td>
</tr>
<tr>
<td><code>_LinuxOrWindowsOnly</code></td>
<td>Not executed because runs under Linux/Windows only</td>
</tr>
<tr>
<td><code>_MacOrWindowsOnly</code></td>
<td>Not executed because runs under Mac OS/Windows only</td>
</tr>
<tr>
<td><code>_MacOnly</code></td>
<td>Not executed because runs under Mac OS only</td>
</tr>
<tr>
<td><code>_NoAcreTests</code></td>
<td>Not executed because it's acre related</td>
</tr>
<tr>
<td><code>_WindowsOnly</code></td>
<td>Not executed because runs under Windows only</td>
</tr>
</tbody>
</table>
<p>Use these to assign an explicit result within any test function. The advantages of this approach:</p>
<ol start="1">
<li>Much more readable than an integer.</li>
<li>You can easily search for, say, <code>_InActive</code>.</li>
</ol>
<p>Notes:</p>
<ul>
<li>There is a method <code>ListSymbolicNames</code> available that lists all symbolic names.</li>
<li>By putting a comment on the line where a constant is assigned you can make sure that this comment is, together with the name of the constant, put into the GUI's “Result” comment.
<p>For example, assuming that <code>Tester2</code> was instanciated with <code>T←⎕NEW Tester2</code>, then this:</p>
<p><code>R←T._Inactive ⍝ Waiting for fix for bug 1291</code></p>
<p>would pop up as “Inactive: Waiting for fix for bug 1291” in the “Result” column for the associated test function.</p></li>
</ul>
<div class="h_tag">
<a href="#Helpers" id="Helpers" class="autoheader_anchor">
<h3 data-id="Helpers">Helpers</h3>
</a>
</div>
<p>These are functions that are not actually required in order to run test cases but can make a programmer's life significantly easier.</p>
<p>These function are discussed in detail at <a href="#managing-test-cases" class="bookmark_link">Managing test cases</a>.</p>
<div class="h_tag">
<a href="#Examples" id="Examples" class="autoheader_anchor">
<h2 data-id="Examples">Examples</h2>
</a>
</div>
<div class="h_tag">
<a href="#Tester2s-Run-functions" id="Tester2s-Run-functions" class="autoheader_anchor">
<h3 data-id="Tester2s-Run-functions"><code>Tester2</code>'s <code>Run*</code> functions</h3>
</a>
</div>
<div class="h_tag">
<a href="#Run" id="Run" class="autoheader_anchor">
<h4 data-id="Run"><code>Run</code></h4>
</a>
</div>
<p>Run requires a Boolean right argument. A 1 makes the test framework stop on a line that fails to return the expected result (<code>PassesIf</code>, <code>FailsIf</code>, <code>GotoTidyUp</code>) while a 0 does not.</p>
<p>The optional left argument must also be Boolean and defines whether the <code>Run</code> function should stop right before any of the test cases is executed (1) or not (0, which is the default).</p>
<div class="h_tag">
<a href="#RunGUI" id="RunGUI" class="autoheader_anchor">
<h4 data-id="RunGUI"><code>RunGUI</code></h4>
</a>
</div>
<p>With <code>RunGUI</code> you can achieve the same as with <code>Run</code> but it is a Windows-only feature. It might be easier to start with <code>RunGUI</code> but you might switch to <code>Run</code> later, if only because it is significantly faster.</p>
<p>However, there are situations when <code>RunGUI</code> is indispensable: <code>Tester2</code>'s own test cases are almost impossible to follow without it, for example. It's also useful in order to demonstrate the features of the <code>Tester2</code> class.</p>
<p><code>RunGUI</code> requires only a right argument; if this is empty <em>all</em> test cases will be executed. You can specify numbers or a group name or mix a group name with ojne or more numbers. You can also precede a group name with a <code>~</code> (without) in order to execute all test cases but the members of that group.</p>
<p>Note that you can specify only one group name.</p>
<p>Notes:</p>
<ul>
<li>The GUI can be closed programmatically by calling the niladic instance method <code>CloseGUI</code>.</li>
<li>You can create a parameter space by calling <code>CreateParms</code>, make amendments and pass the parameter space as the optional left argument to <code>RunGUI</code>. However, since you can make those amendmends in the GUI itself this is useful only to specify defaults for the GUI.</li>
</ul>
<div class="h_tag">
<a href="#RunThese" id="RunThese" class="autoheader_anchor">
<h4 data-id="RunThese"><code>RunThese</code></h4>
</a>
</div>
<p>This method is particularly helpful while developing/enhancing stuff: the function allows you to run just selected test functions rather than a whole test suite.</p>
<p>If you now think, well, why not just call any function <code>Test_001</code> myself then imagine a situation when all your test cases depend on an INI file or the execution of <code>Initial</code> or both. That is exactly the advantage of <code>RunThese</code>: it carries out all these steps for you, and also executes the <code>Cleanup</code> function in case there is one.</p>
<p><code>RunThese</code> offers the following options:</p>
<pre><code>T.RunThese 1                 ⍝ Execute test cases 1 that do not belong to any group
T.RunThese 'Group1'          ⍝ Execute all test cases belonging to Group1
T.RunThese '~Group1'         ⍝ Execute all test cases but those belonging to Group1 (without)
T.RunThese 'Group1' (2 3)    ⍝ Execute test cases 2 &amp; 3 of Group1
T.RunThese 'Group1' 2 3      ⍝ Same as before
T.RunThese 'Misc'            ⍝ Execute all test cases of the group "Misc"
T.RunThese 'L*'              ⍝ Execute all test cases of all groups starting with "L"
T.RunThese 'Group1_001'      ⍝ Executes just this test case
T.RunThese 'Test_Group1_001' ⍝ Same as before</code></pre>
<p>Note that you can specify only one group.</p>
<p>Sometimes you want to trace through test cases. This can be achieved be specifying a 1 as the (optional) left argument. <code>RunThese</code> would then stop just before any test case is actually executed, after processing any INI file(s) and executing any <code>Initial</code> function.</p>
<div class="h_tag">
<a href="#RunBatchTests" id="RunBatchTests" class="autoheader_anchor">
<h3 data-id="RunBatchTests"><code>RunBatchTests</code></h3>
</a>
</div>
<p>This is the same as <code>Run</code> except that it passes a 1 as <code>batchFlag</code> to the test functions. This allows the test function itself to <em>not</em> run any tests. This is usually because a test requires a human in front of the monitor, and if such a human is not available right now then there is no point running such tests.</p>
<div class="h_tag">
<a href="#Run__" id="Run__" class="autoheader_anchor">
<h3 data-id="Run__"><code>Run__</code></h3>
</a>
</div>
<p>This is a generalized function that is effectively called by all the other <code>Run*</code> functions. In case the other functions don't suit your needs, you can use it yourself, although it requires a little more effort:</p>
<pre><code>      ps←T.CreateParms ⍬
      ps._∆List  ⍝ List the defaults
 batchFlag    0
 debugFlag    0
 guiFlag      0
 stopFlag     0
 testCaseNos
 trapFlag     1
      ⍝ Make amendments:
      ps.stopFlag←1
      ps.testCaseNos←'Misc' (1 2 3)
      ⍝ Call the Run__ function:
      (rc log)←T.Run__ ps</code></pre>
<div class="h_tag">
<a href="#Managing-test-cases" id="Managing-test-cases" class="autoheader_anchor">
<h3 data-id="Managing-test-cases">Managing test cases</h3>
</a>
</div>
<p>There are a couple of methods available that assist you in managing test cases.</p>
<p>The examples stem from the <code>Fire</code> project (https://github.com/aplteam/Fire).</p>
<div class="h_tag">
<a href="#Listing-groups" id="Listing-groups" class="autoheader_anchor">
<h4 data-id="Listing-groups">Listing groups</h4>
</a>
</div>
<p><code>ListGroups</code> lists all groups:</p>
<pre><code>      ListGroups
acre
InternalMethods
List
Misc
Replace
ReportGhosts
Search</code></pre>
<div class="h_tag">
<a href="#Listing-symbolic-names" id="Listing-symbolic-names" class="autoheader_anchor">
<h4 data-id="Listing-symbolic-names">Listing symbolic names</h4>
</a>
</div>
<p><code>ListSymbolicNames</code> lists all symbolic names:</p>
<pre><code>      ListSymbolicNames
 _Failed
 _Inactive
 _LinuxOnly
 _LinuxOrMacOnly
 _LinuxOrWindowsOnly
 _MacOnly
 _MacOrWindowsOnly
 _NoAcreTests
 _NoBatchTest
 _NotApplicable
 _NotImplemented
 _OK
 _WindowsOnly</code></pre>
<div class="h_tag">
<a href="#Listing-test-functions" id="Listing-test-functions" class="autoheader_anchor">
<h4 data-id="Listing-test-functions">Listing test functions</h4>
</a>
</div>
<p><code>ListTestFunctions</code> requires a right argument (empty or group name) and accepts an optional left argument (test case numbers).</p>
<pre><code>      ⍴ListTestFunctions ''
99 150

      ListTestFunctions 'Li*'
Test_List_001             Unnamed NSs &amp; GUI instances are ignored.
Test_List_002             Just GUI instances are ignored
Test_List_003             Nothing is ignored at all; instances of GUI objects are ...
Test_List_004             Nothing is ignored but class instances
Test_List_005             Scan all object types but with "Recursive" ← None
Test_List_006             Scan all object types but with "Recursive" ← Just one level
Test_List_007             Search for "Hello" with a ref and an unnamed namespace
    1 7 99 ListTestFunctions 'List'
Test_List_001             Unnamed NSs &amp; GUI instances are ignored.
Test_List_007             Search for "Hello" with a ref and an unnamed namespace
      ⍴ListTestFunctions''
99 2</code></pre>
<p>With a large number of test cases you might prefer to get them into an edit windows. This can be achieved by this command:</p>
<pre><code>'view' ListTestFunctions ''</code></pre>
<p>Notes:</p>
<ul>
<li>Group names must be specified fully or you must specify an asterisk at the end.</li>
<li>Test case numbers that do not exist are simply ignored.</li>
<li>The result is a matrix with two columns: names in <code>[;1]</code> and the first line after the header in <code>[2;]</code>.</li>
</ul>
<div class="h_tag">
<a href="#Editing-test-cases" id="Editing-test-cases" class="autoheader_anchor">
<h4 data-id="Editing-test-cases">Editing test cases</h4>
</a>
</div>
<p>Occasionally you might want to edit some or even all test case functions. That can be easily achieved:</p>
<pre><code>EditTestFunctions''                          ⍝ Edit all test cases
EditTestFunctions T.ListTestFunctions'ZZZ'   ⍝ Edit all test cases of the group "ZZZ"
</code></pre>
<div class="h_tag">
<a href="#Rename-a-test-function" id="Rename-a-test-function" class="autoheader_anchor">
<h4 data-id="Rename-a-test-function">Rename a test function</h4>
</a>
</div>
<p>Renaming a test function is actually harder (and more dangerous) than you might think at first glance, hence the method <code>RenameTestFnsTo</code> is there to assist you.</p>
<p>The syntax:</p>
<pre><code>'oldname' T.RenameTestFnsTo 'newname'</code></pre>
<p>In a real example let's assume that at first you started numbering your test functions. Soon you come to realize that groups would be helpful. But it is awkward to have some test functions carrying just numbers and others group names <em>and</em> numbers. Therefore, it is the good idea to rename those with just a number into, say, <code>Test_Misc_</code> followed by the number.</p>
<p>Therefore this would make sense:</p>
<pre><code>'Test_001' T.RenameTestFnsTo 'Test_Misc_001'</code></pre>
<p><code>RenameTestFnsTo</code> does a couple of things for you:</p>
<ol start="1">
<li>It copies <code>Test_001</code> to <code>Test_Misc_001</code></li>
<li>If the project management system <a href="https://github.com/the-carlisle-group/Acre-Desktop" class="external_link">acre</a> is around it tells acre about the introduction of <code>Test_Misc_001</code></li>
<li>It deletes the function <code>Test_001</code></li>
<li>It tells acre about the deletion of <code>Test_001</code></li>
</ol>
<p>Note that with version 2.2 <code>RenameTestFnsTo</code> has learned to deal with groups as well. This:</p>
<pre><code>'Foo' T.RenameTestFnsTo  'Misc'</code></pre>
<p>Assuming that there is a group “Foo” then all members of that group would be renamed so that they become members of the group “Misc”.</p>
<p>If there is already a group “Misc” then numbering would start with the highest previous number plus 1.</p>
<div class="h_tag">
<a href="#Best-Practices" id="Best-Practices" class="autoheader_anchor">
<h2 data-id="Best-Practices">Best Practices</h2>
</a>
</div>
<ul>
<li>When starting to implement test cases you are advised to leave gaps: <code>Test_001</code>, <code>Test_010</code> etc. The same holds true for numbering within groups.</li>
<li>Try to keep your test cases simple and test just one thing at a time, for example just one method at a time.</li>
<li>For more complex methods (for example when the method accepts different kinds of arguments) create a group with the method name as group name.</li>
<li>Create everything you need on the fly and tidy up afterwards. Or more precisely, tidy up (leftovers!), prepare, test, tidy up again. In other words, make the test case “stand-alone”.
<p>The exception from this rule is when <em>all</em> test cases require the same pre-condition like, say, a database connection. In that case establish what's needed in a function <a href="#initialisation" class="bookmark_link"><code>Initial</code></a> and use a function <a href="#cleaning-up" class="bookmark_link"><code>CleanUp</code></a> to get rid of it.</p>
<p>If all test function of a certain group share the same requirement use <a href="#initialisation-for-groups" class="bookmark_link">Initialisation for groups</a>.</p></li>
<li>Avoid a test case relying on changes made by an earlier test case. This can be a tempting thing to do, but you will almost certainly regret this later.</li>
<li>Notice that the DRY principle (don't repeat yourself) can and should be ignored when it comes to test cases: any test case should read from top to bottom like an independent story that can be understood by itself.</li>
<li>It might  be a good idea for <em>all</em> test functions to tidy up first, just in case this test case has failed earlier and left some debris behind.</li>
<li>It's probably a good idea to implement for every fixed bug a separate test case, for bugs tend to make comebacks all the time, and such a test case would discover such a comeback.</li>
</ul>
</body>
</html>
<!DOCTYPE html>
<html lang="en" style="scroll-behavior:smooth" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>1. Test framework for Unit tests in Dyalog APL</title>
<style media="screen">
html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}body{margin:0;}article,aside,footer,header,nav,section{display:block;}h1{font-size:2em;margin:0.67em 0;}figcaption,figure,main{display:block;}figure{margin:1em 40px;}hr{box-sizing:content-box;height:0;overflow:visible;}pre{font-family:monospace, monospace;font-size:1em;}a{background-color:transparent;-webkit-text-decoration-skip:objects;}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted;}b,strong{font-weight:inherit;}b,strong{font-weight:bolder;}code,kbd,samp{font-family:monospace, monospace;font-size:1em;}dfn{font-style:italic;}mark{background-color:#ff0;color:#000;}small{font-size:0.8em;}sub,sup{font-size:0.75em;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}audio,video{display:inline-block;}audio:not([controls]){display:none;height:0;}img{border-style:none;}svg:not(:root){overflow:hidden;}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:1em;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button,html [type="button"], [type="reset"],[type="submit"]{-webkit-appearance:button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{display:inline-block;vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details, menu{display:block;}summary{display:list-item;}canvas{display:inline-block;}template{display:none;}[hidden]{display:none;}body{margin:0;font-family:"Bookman Old Style", "Callisto MT", Bookman, "Goudy Old Style", Garamond, serif;background-color:#fdfdfd;font-size:18px;line-height:1.4;max-width:900px;padding:0.83em;color:#292929;word-wrap:break-word;overflow-wrap:break-word;}h1, h2, h3, h4, h5, h6{color:#404040;font-weight:800;padding-left:0;}h1, h2, h3, h4, h5, h6{font-family:"Century Gothic", Verdana, "Sans";}h1, h2, h3, h4, p{margin-bottom:0.88em;}h1{font-size:1.8em;margin:0.27em 0 1.11em 0;}h1 > code, h2 > code, h3 > code, h4 > code, h5 > code, h6 > code{font-size:1em;background-color:inherit;}h2{font-size:1.44em;margin:0.55em 0 0.55em 0;padding-top:0.55em;border-bottom:1px solid Silver;}h3{margin:0;margin-top:0.55em;font-size:1.22em;}nav h3{font-size:0.88em;margin-left:0.83em;margin-bottom:0.27em;}h4{font-size:1em;margin:0;margin-top:0.55em;}h5{font-size:0.94em;margin:0;margin-top:0.66em;padding:0;}h6{font-size:0.88em;margin:0;margin-top:0.66em;padding:0;}a{color:#0099ff;margin:0;padding:0;vertical-align:baseline;}a:visited{color:purple;}a.autoheader_anchor{text-decoration:none;}ul{list-style-type:disc;}ul, ol{padding:0;margin:0;}dd{padding-top:0.25em;}p.first_dd{padding-top:0.25em;}li > ul, ol{padding-bottom:0;}li{line-height:1.3;margin-left:1.38em;margin-bottom:0.55em;}ul > li{margin-left:1.11em;}li ul{margin-left:0.55em;}li ul{margin-left:0.27em;}li p{padding:1px 0 0 0;margin:0.55em 0 0.27em 0;line-height:1.3;}p, ul, ol{line-height:1.3;padding:0.44em 0 0 0;margin:0;}pre{overflow:scroll;padding:0.55em 0.27em;margin:0.55em 0 0.55em 0 !important;background-color:#faebd7;color:#3e3e3e;border:1px Silver dashed;display:block;font-family:APLFont, monospace;font-weight:normal;white-space:pre-wrap;}pre > code{line-height:1.2;border:0;padding:0;margin:0;background-color:inherit;color:inherit;font-weight:inherit;white-space:pre-wrap;}a code{padding:0;font-size:1em;}nav code{background-color:inherit;font-weight:400;color:inherit;}code{font-family:APLFont, monospace;background-color:#e7e7e7;color:Black;font-weight:800;line-height:1.2;font-size:0.88em;margin:0;color:#950000;padding:0 0.16em;}tbody tr:nth-child(even){background-color:#F0F0F0;}th{background-color:#E6E6E6;color:black;}th, td{padding:0.16em 0.55em;}table{border-color:Black;margin:1.11em 0 1.11em 0;border:2px black;border-collapse:collapse;font-family:APLFont;font-size:0.88em;line-height:1.2;border:1px solid Gray;}li > table{margin:0.55em 0 0.55em 0;}tr{margin:1.11em;}th{font-weight:bold;}tfoot td{font-weight:bold;}blockquote{border-left:0.27em solid silver;padding-left:0.27em;margin:0.83em 0.27em 0.83em 0.55em;}blockquote ul li{margin-left:1.38em;}blockquote ol li{margin-left:1.38em;}li > blockquote{margin-left:0;}nav{background-color:#f5f5f5;border:1px solid Black;padding:0.55em;margin:0.55em;margin-right:0;box-shadow:0.27em 0.27em 0.27em Gray;overflow:hidden;clear:both;}nav#main_nav{position:fixed;top:0;right:0.55em;float:none;width:auto;}nav#main_nav_no_collapse li{font-size:0.77rem;}nav#main_nav_no_collapse li{line-height:1.5;}nav ul{list-style-type:none;margin:0 0 0.11em 0;padding:0;}nav a:visited{color:black;}nav ul li{margin-bottom:0.16em;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{font-size:0.75rem;line-height:1.3;padding:0;margin-top:0;margin-bottom:0;margin-left:0.83em;}nav p{font-weight:bold;font-size:0.75rem;padding-top:0;}dl{margin-top:0.1em;margin-bottom:0.1em;}dt{margin-top:0.75em;margin-bottom:0.1em;font-weight:800;}label#hide_toc_label{font-size:0.8em;}.toc-container{position:relative;height:auto;}div.toc-container h1{font-size:0.88em;margin:0.27em 0 0.27em 0;}[type="checkbox"]{position:absolute;left:-9999px;}label{display:block;width:100%;height:1.1em;cursor:pointer;top:0;padding-left:1.1em;}label:before{content:'Table of contents \25BC';font-weight:bold;font-size:90%;padding-bottom:0;}[type="checkbox"] ~ div{display:none;}[type="checkbox"]:checked ~ div{display:block;margin-top:1.1em;}[type="checkbox"]:checked + label{top:100%;}[type="checkbox"]:checked + label:before{content:'Table of contents ▲';}div#footnotes_div p{line-height:1;padding-bottom:0;padding-top:0;}div#footnotes_div ol{padding-top:0;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("http://misc.aplteam.com/apl385.ttf") format("truetype");}.no_display{display:none;}.red{color:red;}.center{text-align:center;margin-left:auto;margin-right:auto;}.left{text-align:left;margin-right:0 auto;}.right{text-align:right;margin-left:0 auto;}img{margin-top:0.55em;margin-bottom:0.27em;}div.leanpub{padding:0.83em 0.55em 1.11em 0;margin:0.55em 0 0 0.27em;overflow:auto;}div.leanpub_A{border:1px solid black;background-color:#f1f1f1;padding:0.55em;margin:1.11em 0 0.83em 0;}div.leanpub h3, div.leanpub_A h3{font-size:1.2em;padding:0;margin:0;}div.leanpub h4, div.leanpub_A h4{font-size:1.1em;padding:0.27em 0 0 0;margin:0;}div.leanpub h5, div.leanpub h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub_A h5, div.leanpub_A h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub img{padding:0;margin:0 1.11em 0.27em 0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub img{float:left;padding:0;margin:0.55em 1.11em 0 0;clear:both;}div.leanpub tbody *{background-color:transparent;}div.leanpub p{padding:0.17em 0 0 0;margin:0;}span.leanpub_code{color:Red;}div.leanpub p{display:block;padding:0.44em 0 0 0;}div.leanpub > div{margin-left:2.27em;}.print_only{display:none;}
</style>
<style media="print">
@page{margin:25mm 20mm 25mm 20mm;}body{font-family:"Bookman Old Style", "Callisto MT", Bookman,"Goudy Old Style", Garamond, serif;font-size:9pt;line-height:1.2;}h1{font-size:170%;}h2{font-size:110%;}h3{font-size:110%;}h4{font-size:105%;}h5{font-size:100%;}h6{font-size:95%;}h1{margin:0 0 20pt 0;}h2{margin:15pt 0 3pt 0;}h3{margin:10pt 0 0pt 0;}h4{margin:10pt 0 0pt 0;}h5{margin:9pt 0 0pt 0;}h6{margin:9pt 0 0pt 0;}h1, h2, h3, h4, h5, h6{color:black;font-family:"Century Gothic", Verdana, "Sans";page-break-after:avoid;}h1 > code, h2 > code, h3 > code, h4 > code, h5 > code, h6 > code{font-size:100%;}h2{border-bottom:1pt solid Silver;padding-bottom:2pt;}.h_tag{page-break-after:avoid;break-after:avoid;}abbr[title]{border-bottom:0;text-decoration:none;}a{color:black;margin:0;padding:0;vertical-align:baseline;text-decoration:none;font-style:italic;}a.autoheader_anchor{text-decoration:none;font-style:normal;page-break-after:avoid;break-after:avoid;}ul{list-style-type:square;}ul, ol{padding:0;margin:0;}li > ul, ol{padding-bottom:0;}li{line-height:1.3;margin-left:13pt;margin-bottom:5pt;}ul > li{margin-left:10pt;}li ul{margin-left:5pt;}li ul{margin-left:3pt;}li p{padding:1pt 0 0 0;margin:5pt 0 3pt 0;line-height:1.3;}p, ul, ol{line-height:1.3;padding:4pt 0 0 0;margin:0;color:black;}pre{padding:3pt;margin:5pt 0;white-space:pre-wrap;background-color:#FAFAFA;border:1pt Silver solid;display:block;font-family:APLFont, monospace;page-break-inside:avoid;-webkit-print-color-adjust:exact;}pre code{background-color:#FAFAFA;color:Black;padding:0;margin:0 0 -6pt 0;line-height:1.1;border:0;white-space:pre-wrap;}code{font-family:APLFont, monospace;line-height:1.2;font-size:9pt;padding:3pt 1pt 3pt 1pt;color:#950000;padding:3pt 4pt 3pt 4pt;}tbody th, tfoot tr{background-color:#e6e6e6;}tbody tr:nth-child(even){background-color:#fafafa;}th{background-color:#F0F0F0;}th, td{padding:1pt 5pt;}table{margin:10pt 0;font-family:APLFont;font-size:9pt;padding:0;border:1pt solid silver;-webkit-print-color-adjust:exact;}li > table{margin:10pt 0 10pt 0;}tr{margin:20pt;}th{font-weight:bold;}tfoot td{font-weight:bold;}blockquote{border-left:5pt solid silver;padding-left:5pt;margin:8pt 3pt 8pt 8pt;}nav{background-color:#f8f8f8;border:1pt solid Gray;width:auto;float:right;padding:5pt 5pt 5pt 0;margin:5pt 0 5pt 5pt;page-break-inside:avoid;clear:both;overflow:hidden;}nav *{font-size:75%;}nav ul{list-style-type:none;margin:0 0 2pt 0;padding:0;}nav ul li{margin-bottom:0;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{font-size:9pt;line-height:1;padding:0;margin-top:0;margin-bottom:0;margin-left:8pt;}dl{margin-top:0;margin-bottom:10pt;}dt{margin-top:10pt;margin-bottom:0;font-weight:800;page-break-inside:avoid;}dd{margin-top:2pt;}label#hide_toc_label{font-size:65%;}.toc-container{position:relative;height:auto;margin-top:2pt;background-color:inherit;}.toc-container h3{margin:0 0 2pt 7pt;}[type="checkbox"]{display:none;}label{display:block;width:100%;height:1.1em;top:0;padding-left:10pt;}label:before{content:'Table of contents';font-weight:bold;font-size:140%;padding-bottom:10pt;}a.external_link::before{content:" 🌎";}a.bookmark_link::before{content:" ➯";}a.mailto_link::before{content:" ✉"}nav a.bookmark_link{font-style:normal;}nav p{margin-left:10pt;font-weight:bold;font-size:9pt;}nav a{font-style:normal;}nav a.bookmark_link::before{content:"";}div#footnotes_div a::before{content:"";}div#footnotes_div a{font-style:normal;}div#footnotes_div{page-break-inside:avoid;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("http://misc.aplteam.com/apl385.ttf") format("truetype");}.no_print{display:none;}.red{color:red;}.center{text-align:center;margin:0 auto;}.left{text-align:left;margin-right:0 auto;}.right{text-align:right;margin-left:0 auto;}.avoid_page_break{page-break-inside:avoid;}.page_break_before{page-break-before:always;}div.leanpub{margin:10pt 0 10pt 8pt;page-break-inside:avoid;}div.leanpub_A{border:1pt solid black;background-color:#f9f9f9;padding:5pt;margin:10pt 0 10pt 0;page-break-inside:avoid;}div.leanpub h3, div.leanpub_A h3{font-size:1.2em;padding:3pt 0 0 0;margin:0;}div.leanpub h4, div.leanpub_A h4{font-size:1.1em;padding:3pt 0 0 0;margin:0;}div.leanpub h5, div.leanpub h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub_A h5, div.leanpub_A h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub img{padding:0;margin:0 10pt 2pt 0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub > div > h1:first-child{padding-top:5pt;}div.leanpub img{float:left;padding:0;margin:5pt 10pt 0 0;clear:both;}div.leanpub p{padding:3pt 0 0 0;margin:0;}span.leanpub_code{font-weight:bold;}div.leanpub p{display:block;padding:8pt 0 0 0;}div.leanpub > div{margin-left:35pt;}sup{font-size:0.75em;line-height:0;position:relative;vertical-align:baseline;top:-0.4em;}
</style>

</head>
<body>
<div class="h_tag">
<a href="#Test-framework-for-Unit-tests-in-Dyalog-APL" id="Test-framework-for-Unit-tests-in-Dyalog-APL" class="autoheader_anchor">
<h1>1. Test framework for Unit tests in Dyalog APL</h1>
</a>
</div>
<p><code>Tester2</code> is a member of the APLTree library. This library is a collection of classes etc. that aim to support the Dyalog APL programmer. Search GitHub for “apltree” and you will find solutions to many every-day problems Dyalog APL programmers might have to solve.</p>
<p><strong><em>Note:</em></strong> <code>Tester2</code> is the successor of the <code>Tester</code> class. Although it has inherited the general ideas and concepts from the <code>Tester</code> class the new <code>Tester2</code> class has a very different workflow. Methods have been removed, added and renamed. It was therefore decided to start fresh with a new class.</p>
<p><code>Tester</code> was created roughly 10 years ago. Although it's solved its purpose technology has advanced. Also, during all these years a couple of design problems <code>Tester</code> was suffering from raised their heads. <code>Tester2</code> is an attempt to integrate (almost) latest technology (version 16.0 of Dyalog APL) and to overcome those aforementioned design obstacles.</p>
<div class="h_tag">
<a href="#Overview" id="Overview" class="autoheader_anchor">
<h2>1.1. Overview</h2>
</a>
</div>
<p>The purpose of this class is to provide a framework for testing all the projects of the APLTree library. Only with such a framework is it possible to make changes to any APLTree project with confidence.</p>
<p>You might find the framework flexible enough to suit your own needs when it comes to implementing tests, even independently from the APLTree project.</p>
<p>Depending on how the Test framework is used it might or might not present a GUI. Note that the GUI is a Windows-only feature although in all other respects <code>Tester2</code> works on all platforms; if you decide to avoid the GUI, messages of any kind are printed to the Dyalog session window.</p>
<p>If the GUI shows that's how it looks like:</p>
<p><img src="gui_1.png" alt="The messages" title="The messages"></p>
<p>The “Message” tab shows all the messages the <code>Tester2</code> class provides:</p>
<ul>
<li>Whether there were any INI files instantiated</li>
<li>Whether a function  <code>Initial</code> was found and executed</li>
<li>Which test cases got examined and possibly executed</li>
<li>What the overall picture is:
<ul>
<li>Number of test cases executed</li>
<li>Number of test cases that crashed</li>
<li>Number of test cases that failed</li>
<li>Number of test cases that were inactive</li>
<li>Number of test cases that were not applicable</li>
<li>Number of test cases that are designed to run on different platforms</li>
</ul></li>
<li>Whether  a function  <code>Cleanup</code> was found and executed</li>
</ul>
<p>The “List” tab shows a list of all test cases with…</p>
<ol start="1">
<li>the status in the first column</li>
<li>the name (but without <code>Test_</code>) in the second (status) column</li>
<li>the first comment line in the third column</li>
<li>the symbolic name of the return code, like <code>Failed</code> or <code>WindowsOnly</code> etc. in the fourth column.</li>
</ol>
<p><img src="gui_2.png" alt="This list" title="The list"></p>
<p>The status column shows:</p>
<ul>
<li><code>✓</code> okay</li>
<li><code>*</code> failed</li>
<li><code>#</code> crashed</li>
<li><code>⍝</code> inactive</li>
</ul>
<p>Different status show in different colours.</p>
<p>After all test cases are processed the user might interact with the GUI. These are the commands presented by the context menu:</p>
<p><img src="gui_3.png" alt="Context menu" title="Context menu"></p>
<p>Note that all <code>Run*</code> functions return a two-element vector:</p>
<ol start="1">
<li>[1] is a return code (<code>rc</code>) with 0 for “okay”.</li>
<li>[2] is an empty vector in case <code>rc</code> is 0 and might contain additional information in case <code>rc</code> is not 0.</li>
</ol>
<p>A reference pointing to the GUI is assigned internally. That's why the GUI does not disappear straight away after all test cases have been executed. To get rid of it either click the “Close” box or call the <code>T.CloseGUI</code> method which does not require an argument.</p>
<div class="h_tag">
<a href="#Details" id="Details" class="autoheader_anchor">
<h2>1.2. Details</h2>
</a>
</div>
<div class="h_tag">
<a href="#Terminology" id="Terminology" class="autoheader_anchor">
<h3>1.2.1. Terminology</h3>
</a>
</div>
<p>Note that test cases causing a crash are considered “broken”. Test cases that do not return the expected result are considered “failing”.</p>
<div class="h_tag">
<a href="#Assumptions-and-preconditions" id="Assumptions-and-preconditions" class="autoheader_anchor">
<h3>1.2.2. Assumptions and preconditions</h3>
</a>
</div>
<ol start="1">
<li>The <code>#.Tester2</code> class assumes that all your tests are hosted by a namespace. It may be an ordinary (recommended) or a scripted namespace, but it must not be an unnamed namespace.</li>
<li>You must create an instance of the <code>Tester2</code> class in order to do anything useful. This is <em>the</em> major difference to the now deprecated <code>Tester</code> class.
<p>The constructor demands a right argument: that must be a reference to the namespace that hosts all your test cases.</p>
<p>Example: given that all your test cases live in <code>Foo</code> then you could create an instance <code>T</code> with: <code>T←⎕NEW Tester2 Foo</code></p></li>
<li>All test functions inside their namespace are expected to start their names with <code>Test_</code> followed either by some digits or a group name followed by an underscore followed by some digits, for example <code>Test_Foo_003</code>.
<p>It is recommended that in case you use groups you assign <em>all</em> your test cases to groups.</p></li>
<li>The number of digits you use for numbering is not restricted: <code>Test_foo_1</code> is fine, and so is <code>Test_foo_0000001</code>. However, they should be consistent, at least within a group.</li>
<li>In each test function the first line after the header must carry a comment telling what is actually tested.
<p>Keep in mind that later this is the only way to tell one test case from the others without reading the code, so be as clear as you can possibly be.</p>
<p>You are restricted to a single line, and you should keep it short enough to be displayed with a reasonably setting of <code>⎕PW</code>.</p></li>
</ol>
<div class="h_tag">
<a href="#Executing-test-cases" id="Executing-test-cases" class="autoheader_anchor">
<h3>1.2.3. Executing test cases</h3>
</a>
</div>
<p>There are some typical scenarios when you want to run test cases.</p>
<ul>
<li>Run all test cases, with or without error trapping and with or without stop flag: see the function <code>Run</code>.</li>
<li>Run only a limited selection of all test cases,  with or without error trapping and with or without stop flag: see the function <code>RunThese</code>.</li>
<li>Run only “batchable” test cases, with or without error trapping and with or without stop flag: see the function <code>RunBatchTests</code>.</li>
<li>Run all test cases with a GUI, with or without error trapping and with or without stop flag: see the function <code>RunGUI</code>.</li>
</ul>
<p>All these functions call <code>Run__</code>, which means that this is a generalized all-singing all-dancing function. If none of the above functions fulfil your needs you can call <code>Run__</code> yourself.</p>
<p>Definitions:</p>
<dl>
<dt>Error trapping (<code>trapFlag</code>)</dt>
<dd><p>Traps all errors except that is does not influence the workings of the <code>debugFlag</code>.</p></dd>
<dt>Debugging (<code>debugFlag</code>)</dt>
<dd><p class="first_dd">If this flag is 0 any failing test within any test function just makes the test function quit, returning a return code that has the symbolic name <code>∆Failure</code>. See <a href="#Symbolic-names" class="bookmark_link">Symbolic names</a> for details on this.</p></dd>
<dd><p>If this is 1 then any failing check crashes right on the spot. This allows one to investigate what went wrong, and why.</p></dd>
<dt>Suspend execution (<code>stopFlag</code>)</dt>
<dd><p>If set this makes the test framework stop just before any test function is about to be executed. This allows you to trace any test cases from top to bottom.</p></dd>
<dt>Batchable tests</dt>
<dd><p class="first_dd">These are tests that do not need a human in front of the monitor. Ideally all tests should be “batchable” of course. However, in real life this is not always possible for technical reasons, or the effort would be way too high.</p></dd>
<dd><p>Note that all test cases get the <code>batchFlag</code> provided as part of the right argument, so they know what's required.</p></dd>
</dl>
<div class="h_tag">
<a href="#The-syntax-of-test-functions" id="The-syntax-of-test-functions" class="autoheader_anchor">
<h3>1.2.4. The syntax of test functions</h3>
</a>
</div>
<ol start="1">
<li>Every test function must accept a right argument which is a two-item vector of Booleans:
<ol start="1">
<li><code>debugFlag</code>; 1 means that the test function runs in debug mode.</li>
</ol>
<p>Assuming that all tests use the <a href="#Flow-control" class="bookmark_link">flow ontrol functions</a> provided by <code>Tester2</code> the difference is that with <code>debugFlag</code> being 0 the test function would finish and return the symbolic name <code>Failure</code> while with <code>debugFlag</code> being 1 the test function would crash on the spot when a particular check fails, allowing the user to investigate right away.</p>
<ol start="1">
<li><code>batchFlag</code>: 1 means that there is no user available in front of the mnitor.
<p>That allows a test function that requires a human for confirmation or some action to <em>not</em> carry out the test but return the symbolic name <code>∆NoBatchTest</code>.</p></li>
</ol></li>
<li>Every test function must return a result. You are advised to assign one of the symbolic names defined as read-only fields every instance of <code>Tester2</code> comes with. This is much more readable than a simple integer, and it is easier to find as well. See <a href="#Symbolic-names" class="bookmark_link">Symbolic names</a> for details.</li>
</ol>
<div class="h_tag">
<a href="#Work-flow" id="Work-flow" class="autoheader_anchor">
<h2>1.3. Work flow</h2>
</a>
</div>
<p>No matter which of the <code>Run*</code> functions you are going to call, the workflow is always the same. (There is a minor difference when <code>Run__</code> is used; this will be mentioned)</p>
<div class="h_tag">
<a href="#Create-an-instance" id="Create-an-instance" class="autoheader_anchor">
<h3>1.3.1. Create an instance</h3>
</a>
</div>
<p>First you need an instance. Let's assume that you have a project in <code>#.Foo</code> and that the project's test cases are hosted by the namespace <code>#.Foo.TestCases</code>. You create an instance with:</p>
<pre><code>      T←⎕NEW #.Tester2 #.Foo.TestCases</code></pre>
<p>From then on, all <code>Run</code>* functions, all symbolic names and all other helpers are available via the instance <code>T</code>. Some examples:</p>
<pre><code>      T.RunGUI ⍬
      T.∆OK
      T.PassesIf
      T.⎕nl -3    ⍝ Produces a list of all public instance methods</code></pre>
<p>When you call one of the <code>Run*</code> functions the same steps are executed:</p>
<div class="h_tag">
<a href="#INI-files" id="INI-files" class="autoheader_anchor">
<h3>1.3.2. INI files (optional)</h3>
</a>
</div>
<p>First of all, the <code>Run*</code> methods check whether there is a file <code>testcases.ini</code> in the current directory. If this is the case that INI file is processed. Use this to specify general stuff that does not depend on a certain computer/environment.</p>
<p>Then it checks for a file <code>testcases_{computername}.ini</code>. If this file exists then it is processed. Use this to specify stuff that does depend on a certain computer/environment.</p>
<p>Note that if one or both of the two INI files exist there will be a <em>flat</em> namespace <code>{yourTestNamespace}.INI</code>, meaning that any sections defined in the INI file(s) will be ignored. An example: if your test functions are hosted by a namespace <code>Foo.TestCases</code> and your INI file specifies a variable <code>hello</code> as holding “world” then:</p>
<pre><code>       'world'≡#.Foo.TestCases.INI.hello
1</code></pre>
<div class="h_tag">
<a href="#Initialisation" id="Initialisation" class="autoheader_anchor">
<h3>1.3.3. Initialisation</h3>
</a>
</div>
<p>In the next step the <code>Run*</code> method checks whether there is a function <code>Initial</code> in the hosting namespace. If that is the case then this function is executed.</p>
<p>Note that the function must be either niladic or monadic, and it may return no result at all or a Boolean result. A 1 means that function did what it is supposed to do (=same as no result) while a 0 means it could not initialize.</p>
<p>Of course, you can simply execute <code>→</code> on a single line in your <code>Initial</code> function if any requirement is not met but that would also mean that if you run your test cases automatically as part of, say, an automated build process then this would disrupt the workflow.</p>
<p>In such cases <code>Initial</code> should return a 0 indicating failure. Also, part of the initialization might have been carried out, and a function <code>Cleanup</code> (discussed in a second) might get rid of any left-overs.</p>
<p>If the function is monadic then a reference pointing to the parameter space is passed as the right argument. By checking this parameter space <code>Initial</code> can, for example, find out whether the <code>batchFlag</code> is set or not.</p>
<p>Use <code>Initial</code> to create stuff that's needed by <strong>all</strong> test cases, or tell the user something important (only if the batch flag is false of course).</p>
<div class="h_tag">
<a href="#Finally-running-the-test-cases" id="Finally-running-the-test-cases" class="autoheader_anchor">
<h3>1.3.4. Finally: running the test cases</h3>
</a>
</div>
<p>Now the test cases are executed one by one.</p>
<div class="h_tag">
<a href="#cleanUp" id="cleanUp" class="autoheader_anchor">
<h3>1.3.5. Tidying up: <code>CleanUp</code></h3>
</a>
</div>
<p>After the last test case was executed the <code>Run*</code> function checks whether there is a function <code>Cleanup</code> in the namespace hosting your test cases. If that's the case then this function is executed. Such a function must be a niladic, no-result returning function.</p>
<div class="h_tag">
<a href="#INI-file-again" id="INI-file-again" class="autoheader_anchor">
<h3>1.3.6. INI file again</h3>
</a>
</div>
<p>Finally, the namespace <code>INI</code> holding variables populated from your INI file(s) is deleted.</p>
<div class="h_tag">
<a href="#Instance-methods-offered-by-Tester2" id="Instance-methods-offered-by-Tester2" class="autoheader_anchor">
<h2>1.4. Instance methods offered by <code>Tester2</code></h2>
</a>
</div>
<p>The methods fall into four groups:</p>
<div class="h_tag">
<a href="#Running-test-cases" id="Running-test-cases" class="autoheader_anchor">
<h3>1.4.1. Running test cases</h3>
</a>
</div>
<p><code>Run</code>, <code>RunBatchTests</code>, <code>RunGUI</code>, <code>RunThese</code> and <code>Run__</code> are running all or selected test cases with or without error trapping.</p>
<div class="h_tag">
<a href="#Flow-control" id="Flow-control" class="autoheader_anchor">
<h3>1.4.2. Flow control</h3>
</a>
</div>
<p><code>FailsIf</code>, <code>PassesIf</code> and <code>GoToTidyUp</code> control the program flow in test functions. The test template (see <a href="#Test-function-template" class="bookmark_link"><code>GetTestTemplate</code></a> for details) contains examples for how to use these functions.</p>
<p>These functions return a result (Boolean) in case <code>debugFlag</code> is a 0 but make the calling <code>Test_*</code> function crash otherwise, allowing you to investigate a failing test case right on the spot. Note that the setting of the <code>trapFlag</code> has no bearing on this!</p>
<p>This is achieved by the functions <code>FailsIf</code>, <code>PassesIf</code> and <code>GoToTidyUp</code> signalling an error 999 that can be trapped with:</p>
<pre><code>      ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')</code></pre>
<p>That's why the template for a test function carries such a statement <em>and</em> keeps <code>⎕TRAP</code> local.</p>
<p>Note that <code>GoToTidyUp</code> allows you to jump to a label <code>∆TidyUp</code> with a statement like:</p>
<pre><code> →GoToTidyUp ~expected≡result</code></pre>
<p>This is useful in case a test case needs to do some cleaning up like deleting a temporary file created by the test case. In case the right argument is 1 (rather than 0) it causes a crash in debug mode and carries out the jump otherwise.</p>
<div class="h_tag">
<a href="#Test-function-template" id="Test-function-template" class="autoheader_anchor">
<h3>1.4.3. Test function template</h3>
</a>
</div>
<p>You can get a test function template by calling the instance method <code>GetTestTemplate</code>.</p>
<p>You must provide a number as right argument. The test function will be named <code>Test_{yourNumber}</code>. The number must be between 1 and 999 and will be formatted to a three-character vector.</p>
<p>You can also provide a group name via the optional left argument.</p>
<p>Check the examples which assume that an instance of <code>Tester2</code> is available as <code>T</code>, and that you are inside the (ordinary, non-scripted) namespace that hosts the test cases:</p>
<pre><code>      ≢'T'⎕NL 3
0
      T.GetTestTemplate 3
Test_003
     ≢'T'⎕NL 3
1
      'Misc' T.GetTestTemplate 1
Test_Misc_001
     ≢'T'⎕NL 3
2</code></pre>
<p>Note that in case such a test function already exists you will be prompted.</p>
<p>Note that for technical reasons such a template function cannot be established by <code>GetTestTemplate</code> when the namespace hosting the test cases is scripted. If that is the case you will be prompted for copying the code to the clipboard; it is then up to you to insert the code into the script.</p>
<div class="h_tag">
<a href="#Symbolic-names" id="Symbolic-names" class="autoheader_anchor">
<h3>1.4.4. Symbolic names</h3>
</a>
</div>
<p>These are the public read-only instance fields that act like constants:</p>
<table>
<thead>
<tr>
<th> Name                  </th>
<th> Meaning                                                                     </th>
</tr>
</thead>
<tbody>
<tr>
<td><code>∆OK</code></td>
<td>Passed</td>
</tr>
<tr>
<td><code>∆Failed</code></td>
<td>Unexpected result</td>
</tr>
<tr>
<td><code>∆NoBatchTest</code></td>
<td>Not executed because <code>batchFlag</code> was 1.</td>
</tr>
<tr>
<td><code>∆NotApplicable</code></td>
<td>This test is not applicable here and now</td>
</tr>
<tr>
<td><code>∆InActive</code></td>
<td>Not executed because the test case is inactive (not ready, buggy, …)</td>
</tr>
<tr>
<td><code>∆LinuxOnly</code></td>
<td>Not executed because runs under Linux only</td>
</tr>
<tr>
<td><code>∆LinuxOrMacOnly</code></td>
<td>Not executed because runs under Linux/Mac OS only</td>
</tr>
<tr>
<td><code>∆LinuxOrWindowsOnly</code></td>
<td>Not executed because runs under Linux/Windows only</td>
</tr>
<tr>
<td><code>∆MacOrWindowsOnly</code></td>
<td>Not executed because runs under Mac OS/Windows only</td>
</tr>
<tr>
<td><code>∆MacOnly</code></td>
<td>Not executed because runs under Mac OS only</td>
</tr>
<tr>
<td><code>∆NoAcreTests</code></td>
<td>Not executed because it's acre related</td>
</tr>
<tr>
<td><code>∆WindowsOnly</code></td>
<td>Not executed because runs under Windows only</td>
</tr>
</tbody>
</table>
<p>Use these to assign an explicit result within any test function. The advantages of this approach:</p>
<ol start="1">
<li>Much more readable than an integer.</li>
<li>You can easily search for, say, <code>∆InActive</code>.</li>
</ol>
<p>Note that there is a method <code>ListSymbolicNames</code> available that lists all symbolic names.</p>
<div class="h_tag">
<a href="#Helpers" id="Helpers" class="autoheader_anchor">
<h3>1.4.5. Helpers</h3>
</a>
</div>
<p>These are functions that are not actually required in order to run test cases but can make a programmer's life significantly easier.</p>
<div class="h_tag">
<a href="#ListGroups" id="ListGroups" class="autoheader_anchor">
<h3>1.4.6. <code>ListGroups</code></h3>
</a>
</div>
<p>Use this to list all groups.</p>
<div class="h_tag">
<a href="#ListSymbolicNames" id="ListSymbolicNames" class="autoheader_anchor">
<h3>1.4.7. <code>ListSymbolicNames</code></h3>
</a>
</div>
<p>This method lists all symbolic names any test function may return as result as a one-column matrix:</p>
<pre><code>      ⍴⎕←T.ListSymbolicNames
 ∆Failed
 ∆Inactive
 ∆LinuxOnly
 ∆LinuxOrMacOnly
 ∆LinuxOrWindowsOnly
 ∆MacOnly
 ∆MacOrWindowsOnly
 ∆NoAcreTests
 ∆NoBatchTest
 ∆NotApplicable
 ∆OK
 ∆WindowsOnly
12 1</code></pre>
<div class="h_tag">
<a href="#ListTestFunctions" id="ListTestFunctions" class="autoheader_anchor">
<h3>1.4.8. <code>ListTestFunctions</code></h3>
</a>
</div>
<p>Usee this to list all test functions — if the right argument is empty — together with the first comment line in the function.</p>
<p>The right argument can be used to restrict output to a group, the optional left argument to restrict output to certain numbers.</p>
<p>For example, <code>T.ListTestFunctions 'Misc'</code> would list all test functions of the group “Misc” while <code>T.ListTestFunctions 'M*'</code> would list all test functions that start their names with <code>Test_M</code>.</p>
<div class="h_tag">
<a href="#EditTestFunctions" id="EditTestFunctions" class="autoheader_anchor">
<h3>1.4.9. <code>EditTestFunctions</code></h3>
</a>
</div>
<p>Use this to edit all test functions (empty right argument) or the function(s) identified by the right argument, be it a simple character vector (single name), a vector of character vectors or a matrix.</p>
<p>Note that <code>EditTestFunctions</code> can process the result of <code>ListTestFunctions</code>.</p>
<div class="h_tag">
<a href="#Examples" id="Examples" class="autoheader_anchor">
<h2>1.5. Examples</h2>
</a>
</div>
<div class="h_tag">
<a href="#Tester2s-Run-functions" id="Tester2s-Run-functions" class="autoheader_anchor">
<h3>1.5.1. <code>Tester2</code>'s <code>Run*</code> functions</h3>
</a>
</div>
<div class="h_tag">
<a href="#Run" id="Run" class="autoheader_anchor">
<h4>1.5.1.1. <code>Run</code></h4>
</a>
</div>
<p>Run requires a Boolean right argument. A 1 makes the test framework stop on a line that fails to return the expected result (<code>PassesIf</code>, <code>FailsIf</code>, <code>GotoTidyUp</code>) while a 0 does not.</p>
<p>The optional left argument must also be Boolean and defines whether the <code>Run</code> function should stop right before any of the test cases is executed (1) or not (0, which is the default).</p>
<div class="h_tag">
<a href="#RunGUI" id="RunGUI" class="autoheader_anchor">
<h4>1.5.1.2. <code>RunGUI</code></h4>
</a>
</div>
<p>With <code>RunGUI</code> you can achieve the same as with <code>Run</code> but it is a Windows-only feature. It might be easier to start with <code>RunGUI</code> but you might switch to <code>Run</code> later, if only because it is significantly faster.</p>
<p>However, there are situations when <code>RunGUI</code> is indispensable: <code>Tester2</code>'s own test cases are almost impossible to follow without it, for example. It's also very useful in order to demonstrate the features of the <code>Tester2</code> class.</p>
<p><code>RunGUI</code> requires only a right argument; if this is empty <em>all</em> test cases will be executed. If not empty you can specify numbers or one or more group name or mix a single group name with numbers.</p>
<p>Note that the GUI can be closed programmatically by calling the niladic instance method <code>CloseGUI</code>.</p>
<div class="h_tag">
<a href="#RunThese" id="RunThese" class="autoheader_anchor">
<h4>1.5.1.3. <code>RunThese</code></h4>
</a>
</div>
<p>This method is particularly helpful while developing/enhancing stuff: the function allows you to run just selected test functions rather than a whole test suite.</p>
<p>If you now think, well, why not just call any function <code>Test_001</code> myself then imagine a situation when all your test cases depend on an INI file or the execution of <code>Initial</code> or both. That is exactly the advantage of <code>RunThese</code>: it carries out all these steps, and also executes the <code>Cleanup</code> function in case there is one.</p>
<p><code>RunThese</code> offers the following options:</p>
<pre><code>T.RunThese 1                 ⍝ Execute test cases 1 that do not belong to any group
T.RunThese 'Group1'          ⍝ Execute all test cases belonging to group 1
T.RunThese 'Group1' (2 3)    ⍝ Execute test cases 2 &amp; 3 of group 1
T.RunThese 'Group1' 2 3      ⍝ Same as before
T.RunThese 'Misc'            ⍝ Execute all test cases of the group "Misc"
T.RunThese 'L*'              ⍝ Execute all test cases of all groups starting with "L"
T.RunThese 'Test_Group1_001' ⍝ Executes just this test case</code></pre>
<p>Sometimes you want to trace through test cases. This can be achieved be specifying a 1 as the (optional) left argument. <code>RunThese</code> would then stop just before any test case is actually executed, after processing any INI file(s), executing any <code>Initial</code> function before executing any test case.</p>
<div class="h_tag">
<a href="#RunBatchTests" id="RunBatchTests" class="autoheader_anchor">
<h3>1.5.2. <code>RunBatchTests</code></h3>
</a>
</div>
<p>This is the same as <code>Run</code> except that it passes a 1 as <code>batchFlag</code> to the test functions. This allows the test function itself to <em>not</em> run any tests. This is usually because a test requires a human in front of the monitor, and if such a human is not available right now then there is no point running such tests.</p>
<div class="h_tag">
<a href="#Run__" id="Run__" class="autoheader_anchor">
<h3>1.5.3. <code>Run__</code></h3>
</a>
</div>
<p>This is a generalized function that is effectively called by all the other <code>Run*</code> functions. In case the other functions don't suit your needs, you can use it yourself, although it requires a little more effort:</p>
<pre><code>      ps←T.CreateParms ⍬
      ps.∆List  ⍝ List the defaults
 batchFlag    0
 debugFlag    0
 guiFlag      0
 stopFlag     0
 testCaseNos
 trapFlag     1
      ⍝ Make amendments:
      ps.stopFlag←1
      ps.testCaseNos←'Misc' (1 2 3)
      ⍝ Call the Run__ function:
      (rc log)←T.Run__ ps</code></pre>
<div class="h_tag">
<a href="#Managing-test-cases" id="Managing-test-cases" class="autoheader_anchor">
<h3>1.5.4. Managing test cases</h3>
</a>
</div>
<p>There are a couple of methods available that assist you in managing test cases.</p>
<p>The examples stem from the <code>Fire</code> project.</p>
<div class="h_tag">
<a href="#Listing-groups" id="Listing-groups" class="autoheader_anchor">
<h4>1.5.4.1. Listing groups</h4>
</a>
</div>
<p><code>ListGroups</code> lists all groups:</p>
<pre><code>      ListGroups
acre
InternalMethods
List
Misc
Replace
ReportGhosts
Search</code></pre>
<div class="h_tag">
<a href="#Listing-symbolic-names" id="Listing-symbolic-names" class="autoheader_anchor">
<h4>1.5.4.2. Listing symbolic names</h4>
</a>
</div>
<p><code>ListSymbolicNames</code> lists all symbalic names available:</p>
<pre><code>      ListSymbolicNames
 ∆Failed
 ∆Inactive
 ∆LinuxOnly
 ∆LinuxOrMacOnly
 ∆LinuxOrWindowsOnly
 ∆MacOnly
 ∆MacOrWindowsOnly
 ∆NoAcreTests
 ∆NoBatchTest
 ∆NotApplicable
 ∆OK
 ∆WindowsOnly</code></pre>
<div class="h_tag">
<a href="#Listing-test-functions" id="Listing-test-functions" class="autoheader_anchor">
<h4>1.5.4.3. Listing test functions</h4>
</a>
</div>
<p><code>ListTestFunctions</code> requires a right argument (empty or group name) and accepts an optional left argument (test case numbers).</p>
<pre><code>      ⍴ListTestFunctions ''
99 150

      ListTestFunctions 'Li*'
Test_List_001             Unnamed NSs &amp; GUI instances are ignored.
Test_List_002             Just GUI instances are ignored
Test_List_003             Nothing is ignored at all; instances of GUI objects are ...
Test_List_004             Nothing is ignored but class instances
Test_List_005             Scan all object types but with "Recursive" ← None
Test_List_006             Scan all object types but with "Recursive" ← Just one level
Test_List_007             Search for "Hello" with a ref and an unnamed namespace
    1 7 99 ListTestFunctions 'List'
Test_List_001             Unnamed NSs &amp; GUI instances are ignored.
Test_List_007             Search for "Hello" with a ref and an unnamed namespace
      ⍴ListTestFunctions''
99 2</code></pre>
<p>Notes:</p>
<ul>
<li>Group names must be specified fully or you must specify an asterisk at the end.</li>
<li>Test case numbers that do not exist are simply ignored.</li>
<li>The result is a matrix with two columns, therefore <code>(ListTestFunctions'')[;1]</code> returns a vector of text vectors with test case names.</li>
</ul>
<div class="h_tag">
<a href="#Editing-test-cases" id="Editing-test-cases" class="autoheader_anchor">
<h4>1.5.4.4. Editing test cases</h4>
</a>
</div>
<p>Occasionally you might want to edit some or even all test case functions. That can be easily achieved</p>
<pre><code>EditTestFunctions''                          ⍝ Edit all test cases
EditTestFunctions T.ListTestFunctions'ZZZ'   ⍝ Edit all test cases of the group "ZZZ"
</code></pre>
<div class="h_tag">
<a href="#Rename-a-test-function" id="Rename-a-test-function" class="autoheader_anchor">
<h4>1.5.4.5. Rename a test function</h4>
</a>
</div>
<p>Renaming a test function is actually harder — and more dangerous — than first meets the eye, hence the method <code>RenameTestFnsTo</code> is there to assist you.</p>
<p>The syntax is easy:</p>
<pre><code>'oldname' T.RenameTestFnsTo 'newname'</code></pre>
<p>In a real example let's assume that at first you started numbering your test functions. Soon you came to realize that groups would be helpful. But it is awkward to have some test functions carrying just numbers and others group names <em>and</em> numbers. Therefore, it is the good idea to rename those with just a number into <code>Test_Misc_</code> followed by the number.</p>
<p>Therefore this would make sense:</p>
<pre><code>'Test_001' T.RenameTestFnsTo 'Test_Misc_001'</code></pre>
<p><code>RenameTestFnsTo</code> does a couple of things for you:</p>
<ol start="1">
<li>It copies <code>Test_001</code> to <code>Test_Misc_001</code></li>
<li>It tells the project management system acre[<a href="#fnref1" class="footnote_link"><sup>1</sup></a>] (if it is around) about the introduction of <code>Test_Misc_001</code></li>
<li>It deletes the function <code>Test_001</code></li>
<li>It tells acre about the deletion of <code>Test_001</code></li>
</ol>
<div class="h_tag">
<a href="#Best-Practices" id="Best-Practices" class="autoheader_anchor">
<h2>1.6. Best Practices</h2>
</a>
</div>
<ul>
<li>When starting to implement test cases you are advised to leave gaps: <code>Test_001</code>, <code>Test_010</code> etc. The same holds true for groups.</li>
<li>Try to keep your test cases simple and test just one thing at a time, for example just one method at a time.</li>
<li>For more complex methods (for example when the method accepts different kinds of arguments) create a group with the method name as group name.</li>
<li>Create everything you need on the fly and tidy up afterwards. Or more precisely, tidy up (leftovers!), prepare, test, tidy up again. In other words, make the test case “stand-alone”.
<p>The exception from this rule is when <em>all</em> test cases require the same pre-condition like, say, a database connection. In that case establish what's needed in a function <a href="#Initialisation" class="bookmark_link"><code>Initial</code></a> and use a function <a href="#cleanUp" class="bookmark_link"><code>CleanUp</code></a> to get rid of it.</p></li>
<li>Avoid a test case relying on changes made by an earlier test case. It's a tempting thing to do but you will almost certainly regret this later.</li>
<li>Notice that the DRY principle (don't repeat yourself) can and should be ignored when it comes to test cases: any test case should read from top to bottom like an independent story that can be understood by itself.</li>
<li>It might  be a good idea for <em>all</em> test functions to tidy up in line 1, just in case a failing test case has left something behind; see <a href="#cleanUp" class="bookmark_link">CleanUp</a> for details.</li>
</ul>
<div id="footnotes_div">
<hr>
<p><strong>Footnotes</strong></p>
<ol>
<li id="fnref1"><p>If you do not know what acre is see <a href="https://github.com/the-carlisle-group/Acre-Desktop" class="external_link">https://github.com/the-carlisle-group/Acre-Desktop</a></p><a href="#fnref1" class="footnote_anchor"></a>
</ol>
</div>
</body>
</html>